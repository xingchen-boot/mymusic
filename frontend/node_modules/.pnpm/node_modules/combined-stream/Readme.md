#***REMOVED***combined-stream

A***REMOVED***stream***REMOVED***that***REMOVED***emits***REMOVED***multiple***REMOVED***other***REMOVED***streams***REMOVED***one***REMOVED***after***REMOVED***another.

**NB*****REMOVED***Currently***REMOVED***`combined-stream`***REMOVED***works***REMOVED***with***REMOVED***streams***REMOVED***version***REMOVED***1***REMOVED***only.***REMOVED***There***REMOVED***is***REMOVED***ongoing***REMOVED***effort***REMOVED***to***REMOVED***switch***REMOVED***this***REMOVED***library***REMOVED***to***REMOVED***streams***REMOVED***version***REMOVED***2.***REMOVED***Any***REMOVED***help***REMOVED***is***REMOVED***welcome.***REMOVED***:)***REMOVED***Meanwhile***REMOVED***you***REMOVED***can***REMOVED***explore***REMOVED***other***REMOVED***libraries***REMOVED***that***REMOVED***provide***REMOVED***streams2***REMOVED***support***REMOVED***with***REMOVED***more***REMOVED***or***REMOVED***less***REMOVED***compatibility***REMOVED***with***REMOVED***`combined-stream`.

-***REMOVED***[combined-stream2](https://www.npmjs.com/package/combined-stream2):***REMOVED***A***REMOVED***drop-in***REMOVED***streams2-compatible***REMOVED***replacement***REMOVED***for***REMOVED***the***REMOVED***combined-stream***REMOVED***module.

-***REMOVED***[multistream](https://www.npmjs.com/package/multistream):***REMOVED***A***REMOVED***stream***REMOVED***that***REMOVED***emits***REMOVED***multiple***REMOVED***other***REMOVED***streams***REMOVED***one***REMOVED***after***REMOVED***another.

##***REMOVED***Installation

```***REMOVED***bash
npm***REMOVED***install***REMOVED***combined-stream
```

##***REMOVED***Usage

Here***REMOVED***is***REMOVED***a***REMOVED***simple***REMOVED***example***REMOVED***that***REMOVED***shows***REMOVED***how***REMOVED***you***REMOVED***can***REMOVED***use***REMOVED***combined-stream***REMOVED***to***REMOVED***combine
two***REMOVED***files***REMOVED***into***REMOVED***one:

```***REMOVED***javascript
var***REMOVED***CombinedStream***REMOVED***=***REMOVED***require('combined-stream');
var***REMOVED***fs***REMOVED***=***REMOVED***require('fs');

var***REMOVED***combinedStream***REMOVED***=***REMOVED***CombinedStream.create();
combinedStream.append(fs.createReadStream('file1.txt'));
combinedStream.append(fs.createReadStream('file2.txt'));

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

While***REMOVED***the***REMOVED***example***REMOVED***above***REMOVED***works***REMOVED***great,***REMOVED***it***REMOVED***will***REMOVED***pause***REMOVED***all***REMOVED***source***REMOVED***streams***REMOVED***until
they***REMOVED***are***REMOVED***needed.***REMOVED***If***REMOVED***you***REMOVED***don't***REMOVED***want***REMOVED***that***REMOVED***to***REMOVED***happen,***REMOVED***you***REMOVED***can***REMOVED***set***REMOVED***`pauseStreams`
to***REMOVED***`false`:

```***REMOVED***javascript
var***REMOVED***CombinedStream***REMOVED***=***REMOVED***require('combined-stream');
var***REMOVED***fs***REMOVED***=***REMOVED***require('fs');

var***REMOVED***combinedStream***REMOVED***=***REMOVED***CombinedStream.create({pauseStreams:***REMOVED***false});
combinedStream.append(fs.createReadStream('file1.txt'));
combinedStream.append(fs.createReadStream('file2.txt'));

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

However,***REMOVED***what***REMOVED***if***REMOVED***you***REMOVED***don't***REMOVED***have***REMOVED***all***REMOVED***the***REMOVED***source***REMOVED***streams***REMOVED***yet,***REMOVED***or***REMOVED***you***REMOVED***don't***REMOVED***want
to***REMOVED***allocate***REMOVED***the***REMOVED***resources***REMOVED***(file***REMOVED***descriptors,***REMOVED***memory,***REMOVED***etc.)***REMOVED***for***REMOVED***them***REMOVED***right***REMOVED***away?
Well,***REMOVED***in***REMOVED***that***REMOVED***case***REMOVED***you***REMOVED***can***REMOVED***simply***REMOVED***provide***REMOVED***a***REMOVED***callback***REMOVED***that***REMOVED***supplies***REMOVED***the***REMOVED***stream
by***REMOVED***calling***REMOVED***a***REMOVED***`next()`***REMOVED***function:

```***REMOVED***javascript
var***REMOVED***CombinedStream***REMOVED***=***REMOVED***require('combined-stream');
var***REMOVED***fs***REMOVED***=***REMOVED***require('fs');

var***REMOVED***combinedStream***REMOVED***=***REMOVED***CombinedStream.create();
combinedStream.append(function(next)***REMOVED***{
***REMOVED******REMOVED***next(fs.createReadStream('file1.txt'));
});
combinedStream.append(function(next)***REMOVED***{
***REMOVED******REMOVED***next(fs.createReadStream('file2.txt'));
});

combinedStream.pipe(fs.createWriteStream('combined.txt'));
```

##***REMOVED***API

###***REMOVED***CombinedStream.create([options])

Returns***REMOVED***a***REMOVED***new***REMOVED***combined***REMOVED***stream***REMOVED***object.***REMOVED***Available***REMOVED***options***REMOVED***are:

****REMOVED***`maxDataSize`
****REMOVED***`pauseStreams`

The***REMOVED***effect***REMOVED***of***REMOVED***those***REMOVED***options***REMOVED***is***REMOVED***described***REMOVED***below.

###***REMOVED***combinedStream.pauseStreams***REMOVED***=***REMOVED***`true`

Whether***REMOVED***to***REMOVED***apply***REMOVED***back***REMOVED***pressure***REMOVED***to***REMOVED***the***REMOVED***underlaying***REMOVED***streams.***REMOVED***If***REMOVED***set***REMOVED***to***REMOVED***`false`,
the***REMOVED***underlaying***REMOVED***streams***REMOVED***will***REMOVED***never***REMOVED***be***REMOVED***paused.***REMOVED***If***REMOVED***set***REMOVED***to***REMOVED***`true`,***REMOVED***the
underlaying***REMOVED***streams***REMOVED***will***REMOVED***be***REMOVED***paused***REMOVED***right***REMOVED***after***REMOVED***being***REMOVED***appended,***REMOVED***as***REMOVED***well***REMOVED***as***REMOVED***when
`delayedStream.pipe()`***REMOVED***wants***REMOVED***to***REMOVED***throttle.

###***REMOVED***combinedStream.maxDataSize***REMOVED***=***REMOVED***`2***REMOVED*******REMOVED***1024***REMOVED*******REMOVED***1024`

The***REMOVED***maximum***REMOVED***amount***REMOVED***of***REMOVED***bytes***REMOVED***(or***REMOVED***characters)***REMOVED***to***REMOVED***buffer***REMOVED***for***REMOVED***all***REMOVED***source***REMOVED***streams.
If***REMOVED***this***REMOVED***value***REMOVED***is***REMOVED***exceeded,***REMOVED***`combinedStream`***REMOVED***emits***REMOVED***an***REMOVED***`'error'`***REMOVED***event.

###***REMOVED***combinedStream.dataSize***REMOVED***=***REMOVED***`0`

The***REMOVED***amount***REMOVED***of***REMOVED***bytes***REMOVED***(or***REMOVED***characters)***REMOVED***currently***REMOVED***buffered***REMOVED***by***REMOVED***`combinedStream`.

###***REMOVED***combinedStream.append(stream)

Appends***REMOVED***the***REMOVED***given***REMOVED***`stream`***REMOVED***to***REMOVED***the***REMOVED***combinedStream***REMOVED***object.***REMOVED***If***REMOVED***`pauseStreams`***REMOVED***is
set***REMOVED***to***REMOVED***`true,***REMOVED***this***REMOVED***stream***REMOVED***will***REMOVED***also***REMOVED***be***REMOVED***paused***REMOVED***right***REMOVED***away.

`streams`***REMOVED***can***REMOVED***also***REMOVED***be***REMOVED***a***REMOVED***function***REMOVED***that***REMOVED***takes***REMOVED***one***REMOVED***parameter***REMOVED***called***REMOVED***`next`.***REMOVED***`next`
is***REMOVED***a***REMOVED***function***REMOVED***that***REMOVED***must***REMOVED***be***REMOVED***invoked***REMOVED***in***REMOVED***order***REMOVED***to***REMOVED***provide***REMOVED***the***REMOVED***`next`***REMOVED***stream,***REMOVED***see
example***REMOVED***above.

Regardless***REMOVED***of***REMOVED***how***REMOVED***the***REMOVED***`stream`***REMOVED***is***REMOVED***appended,***REMOVED***combined-stream***REMOVED***always***REMOVED***attaches***REMOVED***an
`'error'`***REMOVED***listener***REMOVED***to***REMOVED***it,***REMOVED***so***REMOVED***you***REMOVED***don't***REMOVED***have***REMOVED***to***REMOVED***do***REMOVED***that***REMOVED***manually.

Special***REMOVED***case:***REMOVED***`stream`***REMOVED***can***REMOVED***also***REMOVED***be***REMOVED***a***REMOVED***String***REMOVED***or***REMOVED***Buffer.

###***REMOVED***combinedStream.write(data)

You***REMOVED***should***REMOVED***not***REMOVED***call***REMOVED***this,***REMOVED***`combinedStream`***REMOVED***takes***REMOVED***care***REMOVED***of***REMOVED***piping***REMOVED***the***REMOVED***appended
streams***REMOVED***into***REMOVED***itself***REMOVED***for***REMOVED***you.

###***REMOVED***combinedStream.resume()

Causes***REMOVED***`combinedStream`***REMOVED***to***REMOVED***start***REMOVED***drain***REMOVED***the***REMOVED***streams***REMOVED***it***REMOVED***manages.***REMOVED***The***REMOVED***function***REMOVED***is
idempotent,***REMOVED***and***REMOVED***also***REMOVED***emits***REMOVED***a***REMOVED***`'resume'`***REMOVED***event***REMOVED***each***REMOVED***time***REMOVED***which***REMOVED***usually***REMOVED***goes***REMOVED***to
the***REMOVED***stream***REMOVED***that***REMOVED***is***REMOVED***currently***REMOVED***being***REMOVED***drained.

###***REMOVED***combinedStream.pause();

If***REMOVED***`combinedStream.pauseStreams`***REMOVED***is***REMOVED***set***REMOVED***to***REMOVED***`false`,***REMOVED***this***REMOVED***does***REMOVED***nothing.
Otherwise***REMOVED***a***REMOVED***`'pause'`***REMOVED***event***REMOVED***is***REMOVED***emitted,***REMOVED***this***REMOVED***goes***REMOVED***to***REMOVED***the***REMOVED***stream***REMOVED***that***REMOVED***is
currently***REMOVED***being***REMOVED***drained,***REMOVED***so***REMOVED***you***REMOVED***can***REMOVED***use***REMOVED***it***REMOVED***to***REMOVED***apply***REMOVED***back***REMOVED***pressure.

###***REMOVED***combinedStream.end();

Sets***REMOVED***`combinedStream.writable`***REMOVED***to***REMOVED***false,***REMOVED***emits***REMOVED***an***REMOVED***`'end'`***REMOVED***event,***REMOVED***and***REMOVED***removes
all***REMOVED***streams***REMOVED***from***REMOVED***the***REMOVED***queue.

###***REMOVED***combinedStream.destroy();

Same***REMOVED***as***REMOVED***`combinedStream.end()`,***REMOVED***except***REMOVED***it***REMOVED***emits***REMOVED***a***REMOVED***`'close'`***REMOVED***event***REMOVED***instead***REMOVED***of
`'end'`.

##***REMOVED***License

combined-stream***REMOVED***is***REMOVED***licensed***REMOVED***under***REMOVED***the***REMOVED***MIT***REMOVED***license.
