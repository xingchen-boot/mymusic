import***REMOVED***isObject***REMOVED***from***REMOVED***'./isObject.js';
import***REMOVED***now***REMOVED***from***REMOVED***'./now.js';
import***REMOVED***toNumber***REMOVED***from***REMOVED***'./toNumber.js';

/*****REMOVED***Error***REMOVED***message***REMOVED***constants.***REMOVED****/
var***REMOVED***FUNC_ERROR_TEXT***REMOVED***=***REMOVED***'Expected***REMOVED***a***REMOVED***function';

/****REMOVED***Built-in***REMOVED***method***REMOVED***references***REMOVED***for***REMOVED***those***REMOVED***with***REMOVED***the***REMOVED***same***REMOVED***name***REMOVED***as***REMOVED***other***REMOVED***`lodash`***REMOVED***methods.***REMOVED****/
var***REMOVED***nativeMax***REMOVED***=***REMOVED***Math.max,
***REMOVED******REMOVED******REMOVED******REMOVED***nativeMin***REMOVED***=***REMOVED***Math.min;

/**
***REMOVED*******REMOVED***Creates***REMOVED***a***REMOVED***debounced***REMOVED***function***REMOVED***that***REMOVED***delays***REMOVED***invoking***REMOVED***`func`***REMOVED***until***REMOVED***after***REMOVED***`wait`
***REMOVED*******REMOVED***milliseconds***REMOVED***have***REMOVED***elapsed***REMOVED***since***REMOVED***the***REMOVED***last***REMOVED***time***REMOVED***the***REMOVED***debounced***REMOVED***function***REMOVED***was
***REMOVED*******REMOVED***invoked.***REMOVED***The***REMOVED***debounced***REMOVED***function***REMOVED***comes***REMOVED***with***REMOVED***a***REMOVED***`cancel`***REMOVED***method***REMOVED***to***REMOVED***cancel
***REMOVED*******REMOVED***delayed***REMOVED***`func`***REMOVED***invocations***REMOVED***and***REMOVED***a***REMOVED***`flush`***REMOVED***method***REMOVED***to***REMOVED***immediately***REMOVED***invoke***REMOVED***them.
***REMOVED*******REMOVED***Provide***REMOVED***`options`***REMOVED***to***REMOVED***indicate***REMOVED***whether***REMOVED***`func`***REMOVED***should***REMOVED***be***REMOVED***invoked***REMOVED***on***REMOVED***the
***REMOVED*******REMOVED***leading***REMOVED***and/or***REMOVED***trailing***REMOVED***edge***REMOVED***of***REMOVED***the***REMOVED***`wait`***REMOVED***timeout.***REMOVED***The***REMOVED***`func`***REMOVED***is***REMOVED***invoked
***REMOVED*******REMOVED***with***REMOVED***the***REMOVED***last***REMOVED***arguments***REMOVED***provided***REMOVED***to***REMOVED***the***REMOVED***debounced***REMOVED***function.***REMOVED***Subsequent
***REMOVED*******REMOVED***calls***REMOVED***to***REMOVED***the***REMOVED***debounced***REMOVED***function***REMOVED***return***REMOVED***the***REMOVED***result***REMOVED***of***REMOVED***the***REMOVED***last***REMOVED***`func`
***REMOVED*******REMOVED***invocation.
***REMOVED****
***REMOVED*******REMOVED*****Note:*****REMOVED***If***REMOVED***`leading`***REMOVED***and***REMOVED***`trailing`***REMOVED***options***REMOVED***are***REMOVED***`true`,***REMOVED***`func`***REMOVED***is
***REMOVED*******REMOVED***invoked***REMOVED***on***REMOVED***the***REMOVED***trailing***REMOVED***edge***REMOVED***of***REMOVED***the***REMOVED***timeout***REMOVED***only***REMOVED***if***REMOVED***the***REMOVED***debounced***REMOVED***function
***REMOVED*******REMOVED***is***REMOVED***invoked***REMOVED***more***REMOVED***than***REMOVED***once***REMOVED***during***REMOVED***the***REMOVED***`wait`***REMOVED***timeout.
***REMOVED****
***REMOVED*******REMOVED***If***REMOVED***`wait`***REMOVED***is***REMOVED***`0`***REMOVED***and***REMOVED***`leading`***REMOVED***is***REMOVED***`false`,***REMOVED***`func`***REMOVED***invocation***REMOVED***is***REMOVED***deferred
***REMOVED*******REMOVED***until***REMOVED***to***REMOVED***the***REMOVED***next***REMOVED***tick,***REMOVED***similar***REMOVED***to***REMOVED***`setTimeout`***REMOVED***with***REMOVED***a***REMOVED***timeout***REMOVED***of***REMOVED***`0`.
***REMOVED****
***REMOVED*******REMOVED***See***REMOVED***[David***REMOVED***Corbacho's***REMOVED***article](https://css-tricks.com/debouncing-throttling-explained-examples/)
***REMOVED*******REMOVED***for***REMOVED***details***REMOVED***over***REMOVED***the***REMOVED***differences***REMOVED***between***REMOVED***`_.debounce`***REMOVED***and***REMOVED***`_.throttle`.
***REMOVED****
***REMOVED*******REMOVED***@static
***REMOVED*******REMOVED***@memberOf***REMOVED***_
***REMOVED*******REMOVED***@since***REMOVED***0.1.0
***REMOVED*******REMOVED***@category***REMOVED***Function
***REMOVED*******REMOVED***@param***REMOVED***{Function}***REMOVED***func***REMOVED***The***REMOVED***function***REMOVED***to***REMOVED***debounce.
***REMOVED*******REMOVED***@param***REMOVED***{number}***REMOVED***[wait=0]***REMOVED***The***REMOVED***number***REMOVED***of***REMOVED***milliseconds***REMOVED***to***REMOVED***delay.
***REMOVED*******REMOVED***@param***REMOVED***{Object}***REMOVED***[options={}]***REMOVED***The***REMOVED***options***REMOVED***object.
***REMOVED*******REMOVED***@param***REMOVED***{boolean}***REMOVED***[options.leading=false]
***REMOVED*******REMOVED******REMOVED***Specify***REMOVED***invoking***REMOVED***on***REMOVED***the***REMOVED***leading***REMOVED***edge***REMOVED***of***REMOVED***the***REMOVED***timeout.
***REMOVED*******REMOVED***@param***REMOVED***{number}***REMOVED***[options.maxWait]
***REMOVED*******REMOVED******REMOVED***The***REMOVED***maximum***REMOVED***time***REMOVED***`func`***REMOVED***is***REMOVED***allowed***REMOVED***to***REMOVED***be***REMOVED***delayed***REMOVED***before***REMOVED***it's***REMOVED***invoked.
***REMOVED*******REMOVED***@param***REMOVED***{boolean}***REMOVED***[options.trailing=true]
***REMOVED*******REMOVED******REMOVED***Specify***REMOVED***invoking***REMOVED***on***REMOVED***the***REMOVED***trailing***REMOVED***edge***REMOVED***of***REMOVED***the***REMOVED***timeout.
***REMOVED*******REMOVED***@returns***REMOVED***{Function}***REMOVED***Returns***REMOVED***the***REMOVED***new***REMOVED***debounced***REMOVED***function.
***REMOVED*******REMOVED***@example
***REMOVED****
***REMOVED*******REMOVED***//***REMOVED***Avoid***REMOVED***costly***REMOVED***calculations***REMOVED***while***REMOVED***the***REMOVED***window***REMOVED***size***REMOVED***is***REMOVED***in***REMOVED***flux.
***REMOVED*******REMOVED***jQuery(window).on('resize',***REMOVED***_.debounce(calculateLayout,***REMOVED***150));
***REMOVED****
***REMOVED*******REMOVED***//***REMOVED***Invoke***REMOVED***`sendMail`***REMOVED***when***REMOVED***clicked,***REMOVED***debouncing***REMOVED***subsequent***REMOVED***calls.
***REMOVED*******REMOVED***jQuery(element).on('click',***REMOVED***_.debounce(sendMail,***REMOVED***300,***REMOVED***{
***REMOVED*******REMOVED******REMOVED******REMOVED***'leading':***REMOVED***true,
***REMOVED*******REMOVED******REMOVED******REMOVED***'trailing':***REMOVED***false
***REMOVED*******REMOVED***}));
***REMOVED****
***REMOVED*******REMOVED***//***REMOVED***Ensure***REMOVED***`batchLog`***REMOVED***is***REMOVED***invoked***REMOVED***once***REMOVED***after***REMOVED***1***REMOVED***second***REMOVED***of***REMOVED***debounced***REMOVED***calls.
***REMOVED*******REMOVED***var***REMOVED***debounced***REMOVED***=***REMOVED***_.debounce(batchLog,***REMOVED***250,***REMOVED***{***REMOVED***'maxWait':***REMOVED***1000***REMOVED***});
***REMOVED*******REMOVED***var***REMOVED***source***REMOVED***=***REMOVED***new***REMOVED***EventSource('/stream');
***REMOVED*******REMOVED***jQuery(source).on('message',***REMOVED***debounced);
***REMOVED****
***REMOVED*******REMOVED***//***REMOVED***Cancel***REMOVED***the***REMOVED***trailing***REMOVED***debounced***REMOVED***invocation.
***REMOVED*******REMOVED***jQuery(window).on('popstate',***REMOVED***debounced.cancel);
***REMOVED****/
function***REMOVED***debounce(func,***REMOVED***wait,***REMOVED***options)***REMOVED***{
***REMOVED******REMOVED***var***REMOVED***lastArgs,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***lastThis,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***maxWait,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***result,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timerId,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***lastCallTime,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***lastInvokeTime***REMOVED***=***REMOVED***0,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***leading***REMOVED***=***REMOVED***false,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***maxing***REMOVED***=***REMOVED***false,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***trailing***REMOVED***=***REMOVED***true;

***REMOVED******REMOVED***if***REMOVED***(typeof***REMOVED***func***REMOVED***!=***REMOVED***'function')***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***throw***REMOVED***new***REMOVED***TypeError(FUNC_ERROR_TEXT);
***REMOVED******REMOVED***}
***REMOVED******REMOVED***wait***REMOVED***=***REMOVED***toNumber(wait)***REMOVED***||***REMOVED***0;
***REMOVED******REMOVED***if***REMOVED***(isObject(options))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***leading***REMOVED***=***REMOVED***!!options.leading;
***REMOVED******REMOVED******REMOVED******REMOVED***maxing***REMOVED***=***REMOVED***'maxWait'***REMOVED***in***REMOVED***options;
***REMOVED******REMOVED******REMOVED******REMOVED***maxWait***REMOVED***=***REMOVED***maxing***REMOVED***?***REMOVED***nativeMax(toNumber(options.maxWait)***REMOVED***||***REMOVED***0,***REMOVED***wait)***REMOVED***:***REMOVED***maxWait;
***REMOVED******REMOVED******REMOVED******REMOVED***trailing***REMOVED***=***REMOVED***'trailing'***REMOVED***in***REMOVED***options***REMOVED***?***REMOVED***!!options.trailing***REMOVED***:***REMOVED***trailing;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***invokeFunc(time)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***args***REMOVED***=***REMOVED***lastArgs,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***thisArg***REMOVED***=***REMOVED***lastThis;

***REMOVED******REMOVED******REMOVED******REMOVED***lastArgs***REMOVED***=***REMOVED***lastThis***REMOVED***=***REMOVED***undefined;
***REMOVED******REMOVED******REMOVED******REMOVED***lastInvokeTime***REMOVED***=***REMOVED***time;
***REMOVED******REMOVED******REMOVED******REMOVED***result***REMOVED***=***REMOVED***func.apply(thisArg,***REMOVED***args);
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***result;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***leadingEdge(time)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Reset***REMOVED***any***REMOVED***`maxWait`***REMOVED***timer.
***REMOVED******REMOVED******REMOVED******REMOVED***lastInvokeTime***REMOVED***=***REMOVED***time;
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Start***REMOVED***the***REMOVED***timer***REMOVED***for***REMOVED***the***REMOVED***trailing***REMOVED***edge.
***REMOVED******REMOVED******REMOVED******REMOVED***timerId***REMOVED***=***REMOVED***setTimeout(timerExpired,***REMOVED***wait);
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Invoke***REMOVED***the***REMOVED***leading***REMOVED***edge.
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***leading***REMOVED***?***REMOVED***invokeFunc(time)***REMOVED***:***REMOVED***result;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***remainingWait(time)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***timeSinceLastCall***REMOVED***=***REMOVED***time***REMOVED***-***REMOVED***lastCallTime,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timeSinceLastInvoke***REMOVED***=***REMOVED***time***REMOVED***-***REMOVED***lastInvokeTime,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timeWaiting***REMOVED***=***REMOVED***wait***REMOVED***-***REMOVED***timeSinceLastCall;

***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***maxing
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***?***REMOVED***nativeMin(timeWaiting,***REMOVED***maxWait***REMOVED***-***REMOVED***timeSinceLastInvoke)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***:***REMOVED***timeWaiting;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***shouldInvoke(time)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***timeSinceLastCall***REMOVED***=***REMOVED***time***REMOVED***-***REMOVED***lastCallTime,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timeSinceLastInvoke***REMOVED***=***REMOVED***time***REMOVED***-***REMOVED***lastInvokeTime;

***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Either***REMOVED***this***REMOVED***is***REMOVED***the***REMOVED***first***REMOVED***call,***REMOVED***activity***REMOVED***has***REMOVED***stopped***REMOVED***and***REMOVED***we're***REMOVED***at***REMOVED***the
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***trailing***REMOVED***edge,***REMOVED***the***REMOVED***system***REMOVED***time***REMOVED***has***REMOVED***gone***REMOVED***backwards***REMOVED***and***REMOVED***we're***REMOVED***treating
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***it***REMOVED***as***REMOVED***the***REMOVED***trailing***REMOVED***edge,***REMOVED***or***REMOVED***we've***REMOVED***hit***REMOVED***the***REMOVED***`maxWait`***REMOVED***limit.
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***(lastCallTime***REMOVED***===***REMOVED***undefined***REMOVED***||***REMOVED***(timeSinceLastCall***REMOVED***>=***REMOVED***wait)***REMOVED***||
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(timeSinceLastCall***REMOVED***<***REMOVED***0)***REMOVED***||***REMOVED***(maxing***REMOVED***&&***REMOVED***timeSinceLastInvoke***REMOVED***>=***REMOVED***maxWait));
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***timerExpired()***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***time***REMOVED***=***REMOVED***now();
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(shouldInvoke(time))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***trailingEdge(time);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Restart***REMOVED***the***REMOVED***timer.
***REMOVED******REMOVED******REMOVED******REMOVED***timerId***REMOVED***=***REMOVED***setTimeout(timerExpired,***REMOVED***remainingWait(time));
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***trailingEdge(time)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***timerId***REMOVED***=***REMOVED***undefined;

***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Only***REMOVED***invoke***REMOVED***if***REMOVED***we***REMOVED***have***REMOVED***`lastArgs`***REMOVED***which***REMOVED***means***REMOVED***`func`***REMOVED***has***REMOVED***been
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***debounced***REMOVED***at***REMOVED***least***REMOVED***once.
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(trailing***REMOVED***&&***REMOVED***lastArgs)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***invokeFunc(time);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***lastArgs***REMOVED***=***REMOVED***lastThis***REMOVED***=***REMOVED***undefined;
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***result;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***cancel()***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(timerId***REMOVED***!==***REMOVED***undefined)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***clearTimeout(timerId);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***lastInvokeTime***REMOVED***=***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED***lastArgs***REMOVED***=***REMOVED***lastCallTime***REMOVED***=***REMOVED***lastThis***REMOVED***=***REMOVED***timerId***REMOVED***=***REMOVED***undefined;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***flush()***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***timerId***REMOVED***===***REMOVED***undefined***REMOVED***?***REMOVED***result***REMOVED***:***REMOVED***trailingEdge(now());
***REMOVED******REMOVED***}

***REMOVED******REMOVED***function***REMOVED***debounced()***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***time***REMOVED***=***REMOVED***now(),
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***isInvoking***REMOVED***=***REMOVED***shouldInvoke(time);

***REMOVED******REMOVED******REMOVED******REMOVED***lastArgs***REMOVED***=***REMOVED***arguments;
***REMOVED******REMOVED******REMOVED******REMOVED***lastThis***REMOVED***=***REMOVED***this;
***REMOVED******REMOVED******REMOVED******REMOVED***lastCallTime***REMOVED***=***REMOVED***time;

***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isInvoking)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(timerId***REMOVED***===***REMOVED***undefined)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***leadingEdge(lastCallTime);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(maxing)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Handle***REMOVED***invocations***REMOVED***in***REMOVED***a***REMOVED***tight***REMOVED***loop.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***clearTimeout(timerId);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timerId***REMOVED***=***REMOVED***setTimeout(timerExpired,***REMOVED***wait);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***invokeFunc(lastCallTime);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(timerId***REMOVED***===***REMOVED***undefined)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***timerId***REMOVED***=***REMOVED***setTimeout(timerExpired,***REMOVED***wait);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***result;
***REMOVED******REMOVED***}
***REMOVED******REMOVED***debounced.cancel***REMOVED***=***REMOVED***cancel;
***REMOVED******REMOVED***debounced.flush***REMOVED***=***REMOVED***flush;
***REMOVED******REMOVED***return***REMOVED***debounced;
}

export***REMOVED***default***REMOVED***debounce;
