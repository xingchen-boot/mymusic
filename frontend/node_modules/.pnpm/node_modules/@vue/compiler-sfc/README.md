#***REMOVED***@vue/compiler-sfc

>***REMOVED***Lower***REMOVED***level***REMOVED***utilities***REMOVED***for***REMOVED***compiling***REMOVED***Vue***REMOVED***Single***REMOVED***File***REMOVED***Components

**Note:***REMOVED***as***REMOVED***of***REMOVED***3.2.13+,***REMOVED***this***REMOVED***package***REMOVED***is***REMOVED***included***REMOVED***as***REMOVED***a***REMOVED***dependency***REMOVED***of***REMOVED***the***REMOVED***main***REMOVED***`vue`***REMOVED***package***REMOVED***and***REMOVED***can***REMOVED***be***REMOVED***accessed***REMOVED***as***REMOVED***`vue/compiler-sfc`.***REMOVED***This***REMOVED***means***REMOVED***you***REMOVED***no***REMOVED***longer***REMOVED***need***REMOVED***to***REMOVED***explicitly***REMOVED***install***REMOVED***this***REMOVED***package***REMOVED***and***REMOVED***ensure***REMOVED***its***REMOVED***version***REMOVED***match***REMOVED***that***REMOVED***of***REMOVED***`vue`'s.***REMOVED***Just***REMOVED***use***REMOVED***the***REMOVED***main***REMOVED***`vue/compiler-sfc`***REMOVED***deep***REMOVED***import***REMOVED***instead.**

This***REMOVED***package***REMOVED***contains***REMOVED***lower***REMOVED***level***REMOVED***utilities***REMOVED***that***REMOVED***you***REMOVED***can***REMOVED***use***REMOVED***if***REMOVED***you***REMOVED***are***REMOVED***writing***REMOVED***a***REMOVED***plugin***REMOVED***/***REMOVED***transform***REMOVED***for***REMOVED***a***REMOVED***bundler***REMOVED***or***REMOVED***module***REMOVED***system***REMOVED***that***REMOVED***compiles***REMOVED***Vue***REMOVED***Single***REMOVED***File***REMOVED***Components***REMOVED***(SFCs)***REMOVED***into***REMOVED***JavaScript.***REMOVED***It***REMOVED***is***REMOVED***used***REMOVED***in***REMOVED***[vue-loader](https://github.com/vuejs/vue-loader)***REMOVED***and***REMOVED***[@vitejs/plugin-vue](https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue).

##***REMOVED***API

The***REMOVED***API***REMOVED***is***REMOVED***intentionally***REMOVED***low-level***REMOVED***due***REMOVED***to***REMOVED***the***REMOVED***various***REMOVED***considerations***REMOVED***when***REMOVED***integrating***REMOVED***Vue***REMOVED***SFCs***REMOVED***in***REMOVED***a***REMOVED***build***REMOVED***system:

-***REMOVED***Separate***REMOVED***hot-module***REMOVED***replacement***REMOVED***(HMR)***REMOVED***for***REMOVED***script,***REMOVED***template***REMOVED***and***REMOVED***styles

***REMOVED******REMOVED***-***REMOVED***template***REMOVED***updates***REMOVED***should***REMOVED***not***REMOVED***reset***REMOVED***component***REMOVED***state
***REMOVED******REMOVED***-***REMOVED***style***REMOVED***updates***REMOVED***should***REMOVED***be***REMOVED***performed***REMOVED***without***REMOVED***component***REMOVED***re-render

-***REMOVED***Leveraging***REMOVED***the***REMOVED***tool's***REMOVED***plugin***REMOVED***system***REMOVED***for***REMOVED***pre-processor***REMOVED***handling.***REMOVED***e.g.***REMOVED***`<style***REMOVED***lang="scss">`***REMOVED***should***REMOVED***be***REMOVED***processed***REMOVED***by***REMOVED***the***REMOVED***corresponding***REMOVED***webpack***REMOVED***loader.

-***REMOVED***In***REMOVED***some***REMOVED***cases,***REMOVED***transformers***REMOVED***of***REMOVED***each***REMOVED***block***REMOVED***in***REMOVED***an***REMOVED***SFC***REMOVED***do***REMOVED***not***REMOVED***share***REMOVED***the***REMOVED***same***REMOVED***execution***REMOVED***context.***REMOVED***For***REMOVED***example,***REMOVED***when***REMOVED***used***REMOVED***with***REMOVED***`thread-loader`***REMOVED***or***REMOVED***other***REMOVED***parallelized***REMOVED***configurations,***REMOVED***the***REMOVED***template***REMOVED***sub-loader***REMOVED***in***REMOVED***`vue-loader`***REMOVED***may***REMOVED***not***REMOVED***have***REMOVED***access***REMOVED***to***REMOVED***the***REMOVED***full***REMOVED***SFC***REMOVED***and***REMOVED***its***REMOVED***descriptor.

The***REMOVED***general***REMOVED***idea***REMOVED***is***REMOVED***to***REMOVED***generate***REMOVED***a***REMOVED***facade***REMOVED***module***REMOVED***that***REMOVED***imports***REMOVED***the***REMOVED***individual***REMOVED***blocks***REMOVED***of***REMOVED***the***REMOVED***component.***REMOVED***The***REMOVED***trick***REMOVED***is***REMOVED***the***REMOVED***module***REMOVED***imports***REMOVED***itself***REMOVED***with***REMOVED***different***REMOVED***query***REMOVED***strings***REMOVED***so***REMOVED***that***REMOVED***the***REMOVED***build***REMOVED***system***REMOVED***can***REMOVED***handle***REMOVED***each***REMOVED***request***REMOVED***as***REMOVED***"virtual"***REMOVED***modules:

```
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED***script***REMOVED***transform***REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+----->+***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
+--------------------+***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
|***REMOVED******REMOVED***facade***REMOVED***transform***REMOVED******REMOVED***+----------->+***REMOVED***template***REMOVED***transform***REMOVED***|
|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
+--------------------+***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+----->+***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED***style***REMOVED***transform***REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***|
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***+--------------------+
```

Where***REMOVED***the***REMOVED***facade***REMOVED***module***REMOVED***looks***REMOVED***like***REMOVED***this:

```js
//***REMOVED***main***REMOVED***script
import***REMOVED***script***REMOVED***from***REMOVED***'/project/foo.vue?vue&type=script'
//***REMOVED***template***REMOVED***compiled***REMOVED***to***REMOVED***render***REMOVED***function
import***REMOVED***{***REMOVED***render***REMOVED***}***REMOVED***from***REMOVED***'/project/foo.vue?vue&type=template&id=xxxxxx'
//***REMOVED***css
import***REMOVED***'/project/foo.vue?vue&type=style&index=0&id=xxxxxx'

//***REMOVED***attach***REMOVED***render***REMOVED***function***REMOVED***to***REMOVED***script
script.render***REMOVED***=***REMOVED***render

//***REMOVED***attach***REMOVED***additional***REMOVED***metadata
//***REMOVED***some***REMOVED***of***REMOVED***these***REMOVED***should***REMOVED***be***REMOVED***dev***REMOVED***only
script.__file***REMOVED***=***REMOVED***'example.vue'
script.__scopeId***REMOVED***=***REMOVED***'xxxxxx'

//***REMOVED***additional***REMOVED***tooling-specific***REMOVED***HMR***REMOVED***handling***REMOVED***code
//***REMOVED***using***REMOVED***__VUE_HMR_API__***REMOVED***global

export***REMOVED***default***REMOVED***script
```

###***REMOVED***High***REMOVED***Level***REMOVED***Workflow

1.***REMOVED***In***REMOVED***facade***REMOVED***transform,***REMOVED***parse***REMOVED***the***REMOVED***source***REMOVED***into***REMOVED***descriptor***REMOVED***with***REMOVED***the***REMOVED***`parse`***REMOVED***API***REMOVED***and***REMOVED***generate***REMOVED***the***REMOVED***above***REMOVED***facade***REMOVED***module***REMOVED***code***REMOVED***based***REMOVED***on***REMOVED***the***REMOVED***descriptor;

2.***REMOVED***In***REMOVED***script***REMOVED***transform,***REMOVED***use***REMOVED***`compileScript`***REMOVED***to***REMOVED***process***REMOVED***the***REMOVED***script.***REMOVED***This***REMOVED***handles***REMOVED***features***REMOVED***like***REMOVED***`<script***REMOVED***setup>`***REMOVED***and***REMOVED***CSS***REMOVED***variable***REMOVED***injection.***REMOVED***Alternatively,***REMOVED***this***REMOVED***can***REMOVED***be***REMOVED***done***REMOVED***directly***REMOVED***in***REMOVED***the***REMOVED***facade***REMOVED***module***REMOVED***(with***REMOVED***the***REMOVED***code***REMOVED***inlined***REMOVED***instead***REMOVED***of***REMOVED***imported),***REMOVED***but***REMOVED***it***REMOVED***will***REMOVED***require***REMOVED***rewriting***REMOVED***`export***REMOVED***default`***REMOVED***to***REMOVED***a***REMOVED***temp***REMOVED***variable***REMOVED***(a***REMOVED***`rewriteDefault`***REMOVED***convenience***REMOVED***API***REMOVED***is***REMOVED***provided***REMOVED***for***REMOVED***this***REMOVED***purpose)***REMOVED***so***REMOVED***additional***REMOVED***options***REMOVED***can***REMOVED***be***REMOVED***attached***REMOVED***to***REMOVED***the***REMOVED***exported***REMOVED***object.

3.***REMOVED***In***REMOVED***template***REMOVED***transform,***REMOVED***use***REMOVED***`compileTemplate`***REMOVED***to***REMOVED***compile***REMOVED***the***REMOVED***raw***REMOVED***template***REMOVED***into***REMOVED***render***REMOVED***function***REMOVED***code.

4.***REMOVED***In***REMOVED***style***REMOVED***transform,***REMOVED***use***REMOVED***`compileStyle`***REMOVED***to***REMOVED***compile***REMOVED***raw***REMOVED***CSS***REMOVED***to***REMOVED***handle***REMOVED***`<style***REMOVED***scoped>`,***REMOVED***`<style***REMOVED***module>`***REMOVED***and***REMOVED***CSS***REMOVED***variable***REMOVED***injection.

Options***REMOVED***needed***REMOVED***for***REMOVED***these***REMOVED***APIs***REMOVED***can***REMOVED***be***REMOVED***passed***REMOVED***via***REMOVED***the***REMOVED***query***REMOVED***string.

For***REMOVED***detailed***REMOVED***API***REMOVED***references***REMOVED***and***REMOVED***options,***REMOVED***check***REMOVED***out***REMOVED***the***REMOVED***source***REMOVED***type***REMOVED***definitions.***REMOVED***For***REMOVED***actual***REMOVED***usage***REMOVED***of***REMOVED***these***REMOVED***APIs,***REMOVED***check***REMOVED***out***REMOVED***[@vitejs/plugin-vue](https://github.com/vitejs/vite-plugin-vue/tree/main/packages/plugin-vue)***REMOVED***or***REMOVED***[vue-loader](https://github.com/vuejs/vue-loader/tree/next).
