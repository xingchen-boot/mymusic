const***REMOVED***fs***REMOVED***=***REMOVED***require('fs')
const***REMOVED***path***REMOVED***=***REMOVED***require('path')

const***REMOVED***dir***REMOVED***=***REMOVED***path.resolve(__dirname,***REMOVED***'..',***REMOVED***'lib')

function***REMOVED***loadModule(name)***REMOVED***{
***REMOVED******REMOVED***try***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***require(name)
***REMOVED******REMOVED***}***REMOVED***catch***REMOVED***(e)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***undefined
***REMOVED******REMOVED***}
}

function***REMOVED***copy(name,***REMOVED***version,***REMOVED***vue)***REMOVED***{
***REMOVED******REMOVED***vue***REMOVED***=***REMOVED***vue***REMOVED***||***REMOVED***'vue'
***REMOVED******REMOVED***const***REMOVED***src***REMOVED***=***REMOVED***path.join(dir,***REMOVED***`v${version}`,***REMOVED***name)
***REMOVED******REMOVED***const***REMOVED***dest***REMOVED***=***REMOVED***path.join(dir,***REMOVED***name)
***REMOVED******REMOVED***let***REMOVED***content***REMOVED***=***REMOVED***fs.readFileSync(src,***REMOVED***'utf-8')
***REMOVED******REMOVED***content***REMOVED***=***REMOVED***content.replace(/'vue'/g,***REMOVED***`'${vue}'`)
***REMOVED******REMOVED***//***REMOVED***unlink***REMOVED***for***REMOVED***pnpm,***REMOVED***#92
***REMOVED******REMOVED***try***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***fs.unlinkSync(dest)
***REMOVED******REMOVED***}***REMOVED***catch***REMOVED***(error)***REMOVED***{***REMOVED***}
***REMOVED******REMOVED***fs.writeFileSync(dest,***REMOVED***content,***REMOVED***'utf-8')
}

function***REMOVED***updateVue2API()***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***ignoreList***REMOVED***=***REMOVED***['version',***REMOVED***'default']
***REMOVED******REMOVED***const***REMOVED***VCA***REMOVED***=***REMOVED***loadModule('@vue/composition-api')
***REMOVED******REMOVED***if***REMOVED***(!VCA)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***console.warn('[vue-demi]***REMOVED***Composition***REMOVED***API***REMOVED***plugin***REMOVED***is***REMOVED***not***REMOVED***found.***REMOVED***Please***REMOVED***run***REMOVED***"npm***REMOVED***install***REMOVED***@vue/composition-api"***REMOVED***to***REMOVED***install.')
***REMOVED******REMOVED******REMOVED******REMOVED***return
***REMOVED******REMOVED***}

***REMOVED******REMOVED***const***REMOVED***exports***REMOVED***=***REMOVED***Object.keys(VCA).filter(i***REMOVED***=>***REMOVED***!ignoreList.includes(i))

***REMOVED******REMOVED***const***REMOVED***esmPath***REMOVED***=***REMOVED***path.join(dir,***REMOVED***'index.mjs')
***REMOVED******REMOVED***let***REMOVED***content***REMOVED***=***REMOVED***fs.readFileSync(esmPath,***REMOVED***'utf-8')

***REMOVED******REMOVED***content***REMOVED***=***REMOVED***content.replace(
***REMOVED******REMOVED******REMOVED******REMOVED***/\/\*\*VCA-EXPORTS\*\*\/[\s\S]+\/\*\*VCA-EXPORTS\*\*\//m,
`/**VCA-EXPORTS**/
export***REMOVED***{***REMOVED***${exports.join(',***REMOVED***')}***REMOVED***}***REMOVED***from***REMOVED***'@vue/composition-api/dist/vue-composition-api.mjs'
/**VCA-EXPORTS**/`
***REMOVED******REMOVED******REMOVED******REMOVED***)

***REMOVED******REMOVED***fs.writeFileSync(esmPath,***REMOVED***content,***REMOVED***'utf-8')
***REMOVED******REMOVED***
}

function***REMOVED***switchVersion(version,***REMOVED***vue)***REMOVED***{
***REMOVED******REMOVED***copy('index.cjs',***REMOVED***version,***REMOVED***vue)
***REMOVED******REMOVED***copy('index.mjs',***REMOVED***version,***REMOVED***vue)
***REMOVED******REMOVED***copy('index.d.ts',***REMOVED***version,***REMOVED***vue)

***REMOVED******REMOVED***if***REMOVED***(version***REMOVED***===***REMOVED***2)
***REMOVED******REMOVED******REMOVED******REMOVED***updateVue2API()
}


module.exports.loadModule***REMOVED***=***REMOVED***loadModule
module.exports.switchVersion***REMOVED***=***REMOVED***switchVersion
