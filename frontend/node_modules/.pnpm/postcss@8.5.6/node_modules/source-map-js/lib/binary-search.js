/****REMOVED***-*-***REMOVED***Mode:***REMOVED***js;***REMOVED***js-indent-level:***REMOVED***2;***REMOVED***-*-***REMOVED****/
/*
***REMOVED*******REMOVED***Copyright***REMOVED***2011***REMOVED***Mozilla***REMOVED***Foundation***REMOVED***and***REMOVED***contributors
***REMOVED*******REMOVED***Licensed***REMOVED***under***REMOVED***the***REMOVED***New***REMOVED***BSD***REMOVED***license.***REMOVED***See***REMOVED***LICENSE***REMOVED***or:
***REMOVED*******REMOVED***http://opensource.org/licenses/BSD-3-Clause
***REMOVED****/

exports.GREATEST_LOWER_BOUND***REMOVED***=***REMOVED***1;
exports.LEAST_UPPER_BOUND***REMOVED***=***REMOVED***2;

/**
***REMOVED*******REMOVED***Recursive***REMOVED***implementation***REMOVED***of***REMOVED***binary***REMOVED***search.
***REMOVED****
***REMOVED*******REMOVED***@param***REMOVED***aLow***REMOVED***Indices***REMOVED***here***REMOVED***and***REMOVED***lower***REMOVED***do***REMOVED***not***REMOVED***contain***REMOVED***the***REMOVED***needle.
***REMOVED*******REMOVED***@param***REMOVED***aHigh***REMOVED***Indices***REMOVED***here***REMOVED***and***REMOVED***higher***REMOVED***do***REMOVED***not***REMOVED***contain***REMOVED***the***REMOVED***needle.
***REMOVED*******REMOVED***@param***REMOVED***aNeedle***REMOVED***The***REMOVED***element***REMOVED***being***REMOVED***searched***REMOVED***for.
***REMOVED*******REMOVED***@param***REMOVED***aHaystack***REMOVED***The***REMOVED***non-empty***REMOVED***array***REMOVED***being***REMOVED***searched.
***REMOVED*******REMOVED***@param***REMOVED***aCompare***REMOVED***Function***REMOVED***which***REMOVED***takes***REMOVED***two***REMOVED***elements***REMOVED***and***REMOVED***returns***REMOVED***-1,***REMOVED***0,***REMOVED***or***REMOVED***1.
***REMOVED*******REMOVED***@param***REMOVED***aBias***REMOVED***Either***REMOVED***'binarySearch.GREATEST_LOWER_BOUND'***REMOVED***or
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***'binarySearch.LEAST_UPPER_BOUND'.***REMOVED***Specifies***REMOVED***whether***REMOVED***to***REMOVED***return***REMOVED***the
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***closest***REMOVED***element***REMOVED***that***REMOVED***is***REMOVED***smaller***REMOVED***than***REMOVED***or***REMOVED***greater***REMOVED***than***REMOVED***the***REMOVED***one***REMOVED***we***REMOVED***are
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***searching***REMOVED***for,***REMOVED***respectively,***REMOVED***if***REMOVED***the***REMOVED***exact***REMOVED***element***REMOVED***cannot***REMOVED***be***REMOVED***found.
***REMOVED****/
function***REMOVED***recursiveSearch(aLow,***REMOVED***aHigh,***REMOVED***aNeedle,***REMOVED***aHaystack,***REMOVED***aCompare,***REMOVED***aBias)***REMOVED***{
***REMOVED******REMOVED***//***REMOVED***This***REMOVED***function***REMOVED***terminates***REMOVED***when***REMOVED***one***REMOVED***of***REMOVED***the***REMOVED***following***REMOVED***is***REMOVED***true:
***REMOVED******REMOVED***//
***REMOVED******REMOVED***//***REMOVED******REMOVED******REMOVED***1.***REMOVED***We***REMOVED***find***REMOVED***the***REMOVED***exact***REMOVED***element***REMOVED***we***REMOVED***are***REMOVED***looking***REMOVED***for.
***REMOVED******REMOVED***//
***REMOVED******REMOVED***//***REMOVED******REMOVED******REMOVED***2.***REMOVED***We***REMOVED***did***REMOVED***not***REMOVED***find***REMOVED***the***REMOVED***exact***REMOVED***element,***REMOVED***but***REMOVED***we***REMOVED***can***REMOVED***return***REMOVED***the***REMOVED***index***REMOVED***of
***REMOVED******REMOVED***//***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***the***REMOVED***next-closest***REMOVED***element.
***REMOVED******REMOVED***//
***REMOVED******REMOVED***//***REMOVED******REMOVED******REMOVED***3.***REMOVED***We***REMOVED***did***REMOVED***not***REMOVED***find***REMOVED***the***REMOVED***exact***REMOVED***element,***REMOVED***and***REMOVED***there***REMOVED***is***REMOVED***no***REMOVED***next-closest
***REMOVED******REMOVED***//***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***element***REMOVED***than***REMOVED***the***REMOVED***one***REMOVED***we***REMOVED***are***REMOVED***searching***REMOVED***for,***REMOVED***so***REMOVED***we***REMOVED***return***REMOVED***-1.
***REMOVED******REMOVED***var***REMOVED***mid***REMOVED***=***REMOVED***Math.floor((aHigh***REMOVED***-***REMOVED***aLow)***REMOVED***/***REMOVED***2)***REMOVED***+***REMOVED***aLow;
***REMOVED******REMOVED***var***REMOVED***cmp***REMOVED***=***REMOVED***aCompare(aNeedle,***REMOVED***aHaystack[mid],***REMOVED***true);
***REMOVED******REMOVED***if***REMOVED***(cmp***REMOVED***===***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Found***REMOVED***the***REMOVED***element***REMOVED***we***REMOVED***are***REMOVED***looking***REMOVED***for.
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***mid;
***REMOVED******REMOVED***}
***REMOVED******REMOVED***else***REMOVED***if***REMOVED***(cmp***REMOVED***>***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Our***REMOVED***needle***REMOVED***is***REMOVED***greater***REMOVED***than***REMOVED***aHaystack[mid].
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(aHigh***REMOVED***-***REMOVED***mid***REMOVED***>***REMOVED***1)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***The***REMOVED***element***REMOVED***is***REMOVED***in***REMOVED***the***REMOVED***upper***REMOVED***half.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***recursiveSearch(mid,***REMOVED***aHigh,***REMOVED***aNeedle,***REMOVED***aHaystack,***REMOVED***aCompare,***REMOVED***aBias);
***REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***The***REMOVED***exact***REMOVED***needle***REMOVED***element***REMOVED***was***REMOVED***not***REMOVED***found***REMOVED***in***REMOVED***this***REMOVED***haystack.***REMOVED***Determine***REMOVED***if
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***we***REMOVED***are***REMOVED***in***REMOVED***termination***REMOVED***case***REMOVED***(3)***REMOVED***or***REMOVED***(2)***REMOVED***and***REMOVED***return***REMOVED***the***REMOVED***appropriate***REMOVED***thing.
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(aBias***REMOVED***==***REMOVED***exports.LEAST_UPPER_BOUND)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***aHigh***REMOVED***<***REMOVED***aHaystack.length***REMOVED***?***REMOVED***aHigh***REMOVED***:***REMOVED***-1;
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***mid;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***Our***REMOVED***needle***REMOVED***is***REMOVED***less***REMOVED***than***REMOVED***aHaystack[mid].
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(mid***REMOVED***-***REMOVED***aLow***REMOVED***>***REMOVED***1)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***The***REMOVED***element***REMOVED***is***REMOVED***in***REMOVED***the***REMOVED***lower***REMOVED***half.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***recursiveSearch(aLow,***REMOVED***mid,***REMOVED***aNeedle,***REMOVED***aHaystack,***REMOVED***aCompare,***REMOVED***aBias);
***REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***we***REMOVED***are***REMOVED***in***REMOVED***termination***REMOVED***case***REMOVED***(3)***REMOVED***or***REMOVED***(2)***REMOVED***and***REMOVED***return***REMOVED***the***REMOVED***appropriate***REMOVED***thing.
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(aBias***REMOVED***==***REMOVED***exports.LEAST_UPPER_BOUND)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***mid;
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***aLow***REMOVED***<***REMOVED***0***REMOVED***?***REMOVED***-1***REMOVED***:***REMOVED***aLow;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
}

/**
***REMOVED*******REMOVED***This***REMOVED***is***REMOVED***an***REMOVED***implementation***REMOVED***of***REMOVED***binary***REMOVED***search***REMOVED***which***REMOVED***will***REMOVED***always***REMOVED***try***REMOVED***and***REMOVED***return
***REMOVED*******REMOVED***the***REMOVED***index***REMOVED***of***REMOVED***the***REMOVED***closest***REMOVED***element***REMOVED***if***REMOVED***there***REMOVED***is***REMOVED***no***REMOVED***exact***REMOVED***hit.***REMOVED***This***REMOVED***is***REMOVED***because
***REMOVED*******REMOVED***mappings***REMOVED***between***REMOVED***original***REMOVED***and***REMOVED***generated***REMOVED***line/col***REMOVED***pairs***REMOVED***are***REMOVED***single***REMOVED***points,
***REMOVED*******REMOVED***and***REMOVED***there***REMOVED***is***REMOVED***an***REMOVED***implicit***REMOVED***region***REMOVED***between***REMOVED***each***REMOVED***of***REMOVED***them,***REMOVED***so***REMOVED***a***REMOVED***miss***REMOVED***just***REMOVED***means
***REMOVED*******REMOVED***that***REMOVED***you***REMOVED***aren't***REMOVED***on***REMOVED***the***REMOVED***very***REMOVED***start***REMOVED***of***REMOVED***a***REMOVED***region.
***REMOVED****
***REMOVED*******REMOVED***@param***REMOVED***aNeedle***REMOVED***The***REMOVED***element***REMOVED***you***REMOVED***are***REMOVED***looking***REMOVED***for.
***REMOVED*******REMOVED***@param***REMOVED***aHaystack***REMOVED***The***REMOVED***array***REMOVED***that***REMOVED***is***REMOVED***being***REMOVED***searched.
***REMOVED*******REMOVED***@param***REMOVED***aCompare***REMOVED***A***REMOVED***function***REMOVED***which***REMOVED***takes***REMOVED***the***REMOVED***needle***REMOVED***and***REMOVED***an***REMOVED***element***REMOVED***in***REMOVED***the
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***array***REMOVED***and***REMOVED***returns***REMOVED***-1,***REMOVED***0,***REMOVED***or***REMOVED***1***REMOVED***depending***REMOVED***on***REMOVED***whether***REMOVED***the***REMOVED***needle***REMOVED***is***REMOVED***less
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***than,***REMOVED***equal***REMOVED***to,***REMOVED***or***REMOVED***greater***REMOVED***than***REMOVED***the***REMOVED***element,***REMOVED***respectively.
***REMOVED*******REMOVED***@param***REMOVED***aBias***REMOVED***Either***REMOVED***'binarySearch.GREATEST_LOWER_BOUND'***REMOVED***or
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***'binarySearch.LEAST_UPPER_BOUND'.***REMOVED***Specifies***REMOVED***whether***REMOVED***to***REMOVED***return***REMOVED***the
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***closest***REMOVED***element***REMOVED***that***REMOVED***is***REMOVED***smaller***REMOVED***than***REMOVED***or***REMOVED***greater***REMOVED***than***REMOVED***the***REMOVED***one***REMOVED***we***REMOVED***are
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***searching***REMOVED***for,***REMOVED***respectively,***REMOVED***if***REMOVED***the***REMOVED***exact***REMOVED***element***REMOVED***cannot***REMOVED***be***REMOVED***found.
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***Defaults***REMOVED***to***REMOVED***'binarySearch.GREATEST_LOWER_BOUND'.
***REMOVED****/
exports.search***REMOVED***=***REMOVED***function***REMOVED***search(aNeedle,***REMOVED***aHaystack,***REMOVED***aCompare,***REMOVED***aBias)***REMOVED***{
***REMOVED******REMOVED***if***REMOVED***(aHaystack.length***REMOVED***===***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***-1;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***var***REMOVED***index***REMOVED***=***REMOVED***recursiveSearch(-1,***REMOVED***aHaystack.length,***REMOVED***aNeedle,***REMOVED***aHaystack,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***aCompare,***REMOVED***aBias***REMOVED***||***REMOVED***exports.GREATEST_LOWER_BOUND);
***REMOVED******REMOVED***if***REMOVED***(index***REMOVED***<***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***-1;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***//***REMOVED***We***REMOVED***have***REMOVED***found***REMOVED***either***REMOVED***the***REMOVED***exact***REMOVED***element,***REMOVED***or***REMOVED***the***REMOVED***next-closest***REMOVED***element***REMOVED***than
***REMOVED******REMOVED***//***REMOVED***the***REMOVED***one***REMOVED***we***REMOVED***are***REMOVED***searching***REMOVED***for.***REMOVED***However,***REMOVED***there***REMOVED***may***REMOVED***be***REMOVED***more***REMOVED***than***REMOVED***one***REMOVED***such
***REMOVED******REMOVED***//***REMOVED***element.***REMOVED***Make***REMOVED***sure***REMOVED***we***REMOVED***always***REMOVED***return***REMOVED***the***REMOVED***smallest***REMOVED***of***REMOVED***these.
***REMOVED******REMOVED***while***REMOVED***(index***REMOVED***-***REMOVED***1***REMOVED***>=***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(aCompare(aHaystack[index],***REMOVED***aHaystack[index***REMOVED***-***REMOVED***1],***REMOVED***true)***REMOVED***!==***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***--index;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***return***REMOVED***index;
};
