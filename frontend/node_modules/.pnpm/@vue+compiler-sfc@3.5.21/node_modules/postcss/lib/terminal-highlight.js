'use***REMOVED***strict'

let***REMOVED***pico***REMOVED***=***REMOVED***require('picocolors')

let***REMOVED***tokenizer***REMOVED***=***REMOVED***require('./tokenize')

let***REMOVED***Input

function***REMOVED***registerInput(dependant)***REMOVED***{
***REMOVED******REMOVED***Input***REMOVED***=***REMOVED***dependant
}

const***REMOVED***HIGHLIGHT_THEME***REMOVED***=***REMOVED***{
***REMOVED******REMOVED***';':***REMOVED***pico.yellow,
***REMOVED******REMOVED***':':***REMOVED***pico.yellow,
***REMOVED******REMOVED***'(':***REMOVED***pico.cyan,
***REMOVED******REMOVED***')':***REMOVED***pico.cyan,
***REMOVED******REMOVED***'[':***REMOVED***pico.yellow,
***REMOVED******REMOVED***']':***REMOVED***pico.yellow,
***REMOVED******REMOVED***'{':***REMOVED***pico.yellow,
***REMOVED******REMOVED***'}':***REMOVED***pico.yellow,
***REMOVED******REMOVED***'at-word':***REMOVED***pico.cyan,
***REMOVED******REMOVED***'brackets':***REMOVED***pico.cyan,
***REMOVED******REMOVED***'call':***REMOVED***pico.cyan,
***REMOVED******REMOVED***'class':***REMOVED***pico.yellow,
***REMOVED******REMOVED***'comment':***REMOVED***pico.gray,
***REMOVED******REMOVED***'hash':***REMOVED***pico.magenta,
***REMOVED******REMOVED***'string':***REMOVED***pico.green
}

function***REMOVED***getTokenType([type,***REMOVED***value],***REMOVED***processor)***REMOVED***{
***REMOVED******REMOVED***if***REMOVED***(type***REMOVED***===***REMOVED***'word')***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(value[0]***REMOVED***===***REMOVED***'.')***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***'class'
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(value[0]***REMOVED***===***REMOVED***'#')***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***'hash'
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}

***REMOVED******REMOVED***if***REMOVED***(!processor.endOfFile())***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***next***REMOVED***=***REMOVED***processor.nextToken()
***REMOVED******REMOVED******REMOVED******REMOVED***processor.back(next)
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(next[0]***REMOVED***===***REMOVED***'brackets'***REMOVED***||***REMOVED***next[0]***REMOVED***===***REMOVED***'(')***REMOVED***return***REMOVED***'call'
***REMOVED******REMOVED***}

***REMOVED******REMOVED***return***REMOVED***type
}

function***REMOVED***terminalHighlight(css)***REMOVED***{
***REMOVED******REMOVED***let***REMOVED***processor***REMOVED***=***REMOVED***tokenizer(new***REMOVED***Input(css),***REMOVED***{***REMOVED***ignoreErrors:***REMOVED***true***REMOVED***})
***REMOVED******REMOVED***let***REMOVED***result***REMOVED***=***REMOVED***''
***REMOVED******REMOVED***while***REMOVED***(!processor.endOfFile())***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***token***REMOVED***=***REMOVED***processor.nextToken()
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***color***REMOVED***=***REMOVED***HIGHLIGHT_THEME[getTokenType(token,***REMOVED***processor)]
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(color)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***result***REMOVED***+=***REMOVED***token[1]
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.split(/\r?\n/)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.map(i***REMOVED***=>***REMOVED***color(i))
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.join('\n')
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***result***REMOVED***+=***REMOVED***token[1]
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***return***REMOVED***result
}

terminalHighlight.registerInput***REMOVED***=***REMOVED***registerInput

module.exports***REMOVED***=***REMOVED***terminalHighlight
