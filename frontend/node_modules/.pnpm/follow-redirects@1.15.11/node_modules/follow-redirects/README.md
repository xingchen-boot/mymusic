##***REMOVED***Follow***REMOVED***Redirects

Drop-in***REMOVED***replacement***REMOVED***for***REMOVED***Node's***REMOVED***`http`***REMOVED***and***REMOVED***`https`***REMOVED***modules***REMOVED***that***REMOVED***automatically***REMOVED***follows***REMOVED***redirects.

[![npm***REMOVED***version](https://img.shields.io/npm/v/follow-redirects.svg)](https://www.npmjs.com/package/follow-redirects)
[![Build***REMOVED***Status](https://github.com/follow-redirects/follow-redirects/workflows/CI/badge.svg)](https://github.com/follow-redirects/follow-redirects/actions)
[![Coverage***REMOVED***Status](https://coveralls.io/repos/follow-redirects/follow-redirects/badge.svg?branch=master)](https://coveralls.io/r/follow-redirects/follow-redirects?branch=master)
[![npm***REMOVED***downloads](https://img.shields.io/npm/dm/follow-redirects.svg)](https://www.npmjs.com/package/follow-redirects)
[![Sponsor***REMOVED***on***REMOVED***GitHub](https://img.shields.io/static/v1?label=Sponsor&message=%F0%9F%92%96&logo=GitHub)](https://github.com/sponsors/RubenVerborgh)

`follow-redirects`***REMOVED***provides***REMOVED***[request](https://nodejs.org/api/http.html#http_http_request_options_callback)***REMOVED***and***REMOVED***[get](https://nodejs.org/api/http.html#http_http_get_options_callback)
***REMOVED***methods***REMOVED***that***REMOVED***behave***REMOVED***identically***REMOVED***to***REMOVED***those***REMOVED***found***REMOVED***on***REMOVED***the***REMOVED***native***REMOVED***[http](https://nodejs.org/api/http.html#http_http_request_options_callback)***REMOVED***and***REMOVED***[https](https://nodejs.org/api/https.html#https_https_request_options_callback)
***REMOVED***modules,***REMOVED***with***REMOVED***the***REMOVED***exception***REMOVED***that***REMOVED***they***REMOVED***will***REMOVED***seamlessly***REMOVED***follow***REMOVED***redirects.

```javascript
const***REMOVED***{***REMOVED***http,***REMOVED***https***REMOVED***}***REMOVED***=***REMOVED***require('follow-redirects');

http.get('http://bit.ly/900913',***REMOVED***response***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***response.on('data',***REMOVED***chunk***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***console.log(chunk);
***REMOVED******REMOVED***});
}).on('error',***REMOVED***err***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***console.error(err);
});
```

You***REMOVED***can***REMOVED***inspect***REMOVED***the***REMOVED***final***REMOVED***redirected***REMOVED***URL***REMOVED***through***REMOVED***the***REMOVED***`responseUrl`***REMOVED***property***REMOVED***on***REMOVED***the***REMOVED***`response`.
If***REMOVED***no***REMOVED***redirection***REMOVED***happened,***REMOVED***`responseUrl`***REMOVED***is***REMOVED***the***REMOVED***original***REMOVED***request***REMOVED***URL.

```javascript
const***REMOVED***request***REMOVED***=***REMOVED***https.request({
***REMOVED******REMOVED***host:***REMOVED***'bitly.com',
***REMOVED******REMOVED***path:***REMOVED***'/UHfDGO',
},***REMOVED***response***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***console.log(response.responseUrl);
***REMOVED******REMOVED***//***REMOVED***'http://duckduckgo.com/robots.txt'
});
request.end();
```

##***REMOVED***Options
###***REMOVED***Global***REMOVED***options
Global***REMOVED***options***REMOVED***are***REMOVED***set***REMOVED***directly***REMOVED***on***REMOVED***the***REMOVED***`follow-redirects`***REMOVED***module:

```javascript
const***REMOVED***followRedirects***REMOVED***=***REMOVED***require('follow-redirects');
followRedirects.maxRedirects***REMOVED***=***REMOVED***10;
followRedirects.maxBodyLength***REMOVED***=***REMOVED***20***REMOVED*******REMOVED***1024***REMOVED*******REMOVED***1024;***REMOVED***//***REMOVED***20***REMOVED***MB
```

The***REMOVED***following***REMOVED***global***REMOVED***options***REMOVED***are***REMOVED***supported:

-***REMOVED***`maxRedirects`***REMOVED***(default:***REMOVED***`21`)***REMOVED***–***REMOVED***sets***REMOVED***the***REMOVED***maximum***REMOVED***number***REMOVED***of***REMOVED***allowed***REMOVED***redirects;***REMOVED***if***REMOVED***exceeded,***REMOVED***an***REMOVED***error***REMOVED***will***REMOVED***be***REMOVED***emitted.

-***REMOVED***`maxBodyLength`***REMOVED***(default:***REMOVED***10MB)***REMOVED***–***REMOVED***sets***REMOVED***the***REMOVED***maximum***REMOVED***size***REMOVED***of***REMOVED***the***REMOVED***request***REMOVED***body;***REMOVED***if***REMOVED***exceeded,***REMOVED***an***REMOVED***error***REMOVED***will***REMOVED***be***REMOVED***emitted.

###***REMOVED***Per-request***REMOVED***options
Per-request***REMOVED***options***REMOVED***are***REMOVED***set***REMOVED***by***REMOVED***passing***REMOVED***an***REMOVED***`options`***REMOVED***object:

```javascript
const***REMOVED***url***REMOVED***=***REMOVED***require('url');
const***REMOVED***{***REMOVED***http,***REMOVED***https***REMOVED***}***REMOVED***=***REMOVED***require('follow-redirects');

const***REMOVED***options***REMOVED***=***REMOVED***url.parse('http://bit.ly/900913');
options.maxRedirects***REMOVED***=***REMOVED***10;
options.beforeRedirect***REMOVED***=***REMOVED***(options,***REMOVED***response,***REMOVED***request)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***//***REMOVED***Use***REMOVED***this***REMOVED***to***REMOVED***adjust***REMOVED***the***REMOVED***request***REMOVED***options***REMOVED***upon***REMOVED***redirecting,
***REMOVED******REMOVED***//***REMOVED***to***REMOVED***inspect***REMOVED***the***REMOVED***latest***REMOVED***response***REMOVED***headers,
***REMOVED******REMOVED***//***REMOVED***or***REMOVED***to***REMOVED***cancel***REMOVED***the***REMOVED***request***REMOVED***by***REMOVED***throwing***REMOVED***an***REMOVED***error

***REMOVED******REMOVED***//***REMOVED***response.headers***REMOVED***=***REMOVED***the***REMOVED***redirect***REMOVED***response***REMOVED***headers
***REMOVED******REMOVED***//***REMOVED***response.statusCode***REMOVED***=***REMOVED***the***REMOVED***redirect***REMOVED***response***REMOVED***code***REMOVED***(eg.***REMOVED***301,***REMOVED***307,***REMOVED***etc.)

***REMOVED******REMOVED***//***REMOVED***request.url***REMOVED***=***REMOVED***the***REMOVED***requested***REMOVED***URL***REMOVED***that***REMOVED***resulted***REMOVED***in***REMOVED***a***REMOVED***redirect
***REMOVED******REMOVED***//***REMOVED***request.headers***REMOVED***=***REMOVED***the***REMOVED***headers***REMOVED***in***REMOVED***the***REMOVED***request***REMOVED***that***REMOVED***resulted***REMOVED***in***REMOVED***a***REMOVED***redirect
***REMOVED******REMOVED***//***REMOVED***request.method***REMOVED***=***REMOVED***the***REMOVED***method***REMOVED***of***REMOVED***the***REMOVED***request***REMOVED***that***REMOVED***resulted***REMOVED***in***REMOVED***a***REMOVED***redirect
***REMOVED******REMOVED***if***REMOVED***(options.hostname***REMOVED***===***REMOVED***"example.com")***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***options.auth***REMOVED***=***REMOVED***"user:password";
***REMOVED******REMOVED***}
};
http.request(options);
```

In***REMOVED***addition***REMOVED***to***REMOVED***the***REMOVED***[standard***REMOVED***HTTP](https://nodejs.org/api/http.html#http_http_request_options_callback)***REMOVED***and***REMOVED***[HTTPS***REMOVED***options](https://nodejs.org/api/https.html#https_https_request_options_callback),
the***REMOVED***following***REMOVED***per-request***REMOVED***options***REMOVED***are***REMOVED***supported:
-***REMOVED***`followRedirects`***REMOVED***(default:***REMOVED***`true`)***REMOVED***–***REMOVED***whether***REMOVED***redirects***REMOVED***should***REMOVED***be***REMOVED***followed.

-***REMOVED***`maxRedirects`***REMOVED***(default:***REMOVED***`21`)***REMOVED***–***REMOVED***sets***REMOVED***the***REMOVED***maximum***REMOVED***number***REMOVED***of***REMOVED***allowed***REMOVED***redirects;***REMOVED***if***REMOVED***exceeded,***REMOVED***an***REMOVED***error***REMOVED***will***REMOVED***be***REMOVED***emitted.

-***REMOVED***`maxBodyLength`***REMOVED***(default:***REMOVED***10MB)***REMOVED***–***REMOVED***sets***REMOVED***the***REMOVED***maximum***REMOVED***size***REMOVED***of***REMOVED***the***REMOVED***request***REMOVED***body;***REMOVED***if***REMOVED***exceeded,***REMOVED***an***REMOVED***error***REMOVED***will***REMOVED***be***REMOVED***emitted.

-***REMOVED***`beforeRedirect`***REMOVED***(default:***REMOVED***`undefined`)***REMOVED***–***REMOVED***optionally***REMOVED***change***REMOVED***the***REMOVED***request***REMOVED***`options`***REMOVED***on***REMOVED***redirects,***REMOVED***or***REMOVED***abort***REMOVED***the***REMOVED***request***REMOVED***by***REMOVED***throwing***REMOVED***an***REMOVED***error.

-***REMOVED***`agents`***REMOVED***(default:***REMOVED***`undefined`)***REMOVED***–***REMOVED***sets***REMOVED***the***REMOVED***`agent`***REMOVED***option***REMOVED***per***REMOVED***protocol,***REMOVED***since***REMOVED***HTTP***REMOVED***and***REMOVED***HTTPS***REMOVED***use***REMOVED***different***REMOVED***agents.***REMOVED***Example***REMOVED***value:***REMOVED***`{***REMOVED***http:***REMOVED***new***REMOVED***http.Agent(),***REMOVED***https:***REMOVED***new***REMOVED***https.Agent()***REMOVED***}`

-***REMOVED***`trackRedirects`***REMOVED***(default:***REMOVED***`false`)***REMOVED***–***REMOVED***whether***REMOVED***to***REMOVED***store***REMOVED***the***REMOVED***redirected***REMOVED***response***REMOVED***details***REMOVED***into***REMOVED***the***REMOVED***`redirects`***REMOVED***array***REMOVED***on***REMOVED***the***REMOVED***response***REMOVED***object.


###***REMOVED***Advanced***REMOVED***usage
By***REMOVED***default,***REMOVED***`follow-redirects`***REMOVED***will***REMOVED***use***REMOVED***the***REMOVED***Node.js***REMOVED***default***REMOVED***implementations
of***REMOVED***[`http`](https://nodejs.org/api/http.html)
and***REMOVED***[`https`](https://nodejs.org/api/https.html).
To***REMOVED***enable***REMOVED***features***REMOVED***such***REMOVED***as***REMOVED***caching***REMOVED***and/or***REMOVED***intermediate***REMOVED***request***REMOVED***tracking,
you***REMOVED***might***REMOVED***instead***REMOVED***want***REMOVED***to***REMOVED***wrap***REMOVED***`follow-redirects`***REMOVED***around***REMOVED***custom***REMOVED***protocol***REMOVED***implementations:

```javascript
const***REMOVED***{***REMOVED***http,***REMOVED***https***REMOVED***}***REMOVED***=***REMOVED***require('follow-redirects').wrap({
***REMOVED******REMOVED***http:***REMOVED***require('your-custom-http'),
***REMOVED******REMOVED***https:***REMOVED***require('your-custom-https'),
});
```

Such***REMOVED***custom***REMOVED***protocols***REMOVED***only***REMOVED***need***REMOVED***an***REMOVED***implementation***REMOVED***of***REMOVED***the***REMOVED***`request`***REMOVED***method.

##***REMOVED***Browser***REMOVED***Usage

Due***REMOVED***to***REMOVED***the***REMOVED***way***REMOVED***the***REMOVED***browser***REMOVED***works,
the***REMOVED***`http`***REMOVED***and***REMOVED***`https`***REMOVED***browser***REMOVED***equivalents***REMOVED***perform***REMOVED***redirects***REMOVED***by***REMOVED***default.

By***REMOVED***requiring***REMOVED***`follow-redirects`***REMOVED***this***REMOVED***way:
```javascript
const***REMOVED***http***REMOVED***=***REMOVED***require('follow-redirects/http');
const***REMOVED***https***REMOVED***=***REMOVED***require('follow-redirects/https');
```
you***REMOVED***can***REMOVED***easily***REMOVED***tell***REMOVED***webpack***REMOVED***and***REMOVED***friends***REMOVED***to***REMOVED***replace
`follow-redirect`***REMOVED***by***REMOVED***the***REMOVED***built-in***REMOVED***versions:

```json
{
***REMOVED******REMOVED***"follow-redirects/http"***REMOVED******REMOVED***:***REMOVED***"http",
***REMOVED******REMOVED***"follow-redirects/https"***REMOVED***:***REMOVED***"https"
}
```

##***REMOVED***Contributing

Pull***REMOVED***Requests***REMOVED***are***REMOVED***always***REMOVED***welcome.***REMOVED***Please***REMOVED***[file***REMOVED***an***REMOVED***issue](https://github.com/follow-redirects/follow-redirects/issues)
***REMOVED***detailing***REMOVED***your***REMOVED***proposal***REMOVED***before***REMOVED***you***REMOVED***invest***REMOVED***your***REMOVED***valuable***REMOVED***time.***REMOVED***Additional***REMOVED***features***REMOVED***and***REMOVED***bug***REMOVED***fixes***REMOVED***should***REMOVED***be***REMOVED***accompanied
***REMOVED***by***REMOVED***tests.***REMOVED***You***REMOVED***can***REMOVED***run***REMOVED***the***REMOVED***test***REMOVED***suite***REMOVED***locally***REMOVED***with***REMOVED***a***REMOVED***simple***REMOVED***`npm***REMOVED***test`***REMOVED***command.

##***REMOVED***Debug***REMOVED***Logging

`follow-redirects`***REMOVED***uses***REMOVED***the***REMOVED***excellent***REMOVED***[debug](https://www.npmjs.com/package/debug)***REMOVED***for***REMOVED***logging.***REMOVED***To***REMOVED***turn***REMOVED***on***REMOVED***logging
***REMOVED***set***REMOVED***the***REMOVED***environment***REMOVED***variable***REMOVED***`DEBUG=follow-redirects`***REMOVED***for***REMOVED***debug***REMOVED***output***REMOVED***from***REMOVED***just***REMOVED***this***REMOVED***module.***REMOVED***When***REMOVED***running***REMOVED***the***REMOVED***test
***REMOVED***suite***REMOVED***it***REMOVED***is***REMOVED***sometimes***REMOVED***advantageous***REMOVED***to***REMOVED***set***REMOVED***`DEBUG=*`***REMOVED***to***REMOVED***see***REMOVED***output***REMOVED***from***REMOVED***the***REMOVED***express***REMOVED***server***REMOVED***as***REMOVED***well.

##***REMOVED***Authors

-***REMOVED***[Ruben***REMOVED***Verborgh](https://ruben.verborgh.org/)
-***REMOVED***[Olivier***REMOVED***Lalonde](mailto:olalonde@gmail.com)
-***REMOVED***[James***REMOVED***Talmage](mailto:james@talmage.io)

##***REMOVED***License

[MIT***REMOVED***License](https://github.com/follow-redirects/follow-redirects/blob/master/LICENSE)
