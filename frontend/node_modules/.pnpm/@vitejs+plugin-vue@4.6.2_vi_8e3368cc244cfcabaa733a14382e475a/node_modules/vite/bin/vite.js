#!/usr/bin/env***REMOVED***node
import***REMOVED***{***REMOVED***performance***REMOVED***}***REMOVED***from***REMOVED***'node:perf_hooks'

if***REMOVED***(!import.meta.url.includes('node_modules'))***REMOVED***{
***REMOVED******REMOVED***try***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***only***REMOVED***available***REMOVED***as***REMOVED***dev***REMOVED***dependency
***REMOVED******REMOVED******REMOVED******REMOVED***await***REMOVED***import('source-map-support').then((r)***REMOVED***=>***REMOVED***r.default.install())
***REMOVED******REMOVED***}***REMOVED***catch***REMOVED***(e)***REMOVED***{}
}

global.__vite_start_time***REMOVED***=***REMOVED***performance.now()

//***REMOVED***check***REMOVED***debug***REMOVED***mode***REMOVED***first***REMOVED***before***REMOVED***requiring***REMOVED***the***REMOVED***CLI.
const***REMOVED***debugIndex***REMOVED***=***REMOVED***process.argv.findIndex((arg)***REMOVED***=>***REMOVED***/^(?:-d|--debug)$/.test(arg))
const***REMOVED***filterIndex***REMOVED***=***REMOVED***process.argv.findIndex((arg)***REMOVED***=>
***REMOVED******REMOVED***/^(?:-f|--filter)$/.test(arg),
)
const***REMOVED***profileIndex***REMOVED***=***REMOVED***process.argv.indexOf('--profile')

if***REMOVED***(debugIndex***REMOVED***>***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED***let***REMOVED***value***REMOVED***=***REMOVED***process.argv[debugIndex***REMOVED***+***REMOVED***1]
***REMOVED******REMOVED***if***REMOVED***(!value***REMOVED***||***REMOVED***value.startsWith('-'))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***value***REMOVED***=***REMOVED***'vite:*'
***REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***support***REMOVED***debugging***REMOVED***multiple***REMOVED***flags***REMOVED***with***REMOVED***comma-separated***REMOVED***list
***REMOVED******REMOVED******REMOVED******REMOVED***value***REMOVED***=***REMOVED***value
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.split(',')
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.map((v)***REMOVED***=>***REMOVED***`vite:${v}`)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***.join(',')
***REMOVED******REMOVED***}
***REMOVED******REMOVED***process.env.DEBUG***REMOVED***=***REMOVED***`${
***REMOVED******REMOVED******REMOVED******REMOVED***process.env.DEBUG***REMOVED***?***REMOVED***process.env.DEBUG***REMOVED***+***REMOVED***','***REMOVED***:***REMOVED***''
***REMOVED******REMOVED***}${value}`

***REMOVED******REMOVED***if***REMOVED***(filterIndex***REMOVED***>***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***filter***REMOVED***=***REMOVED***process.argv[filterIndex***REMOVED***+***REMOVED***1]
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(filter***REMOVED***&&***REMOVED***!filter.startsWith('-'))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***process.env.VITE_DEBUG_FILTER***REMOVED***=***REMOVED***filter
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
}

function***REMOVED***start()***REMOVED***{
***REMOVED******REMOVED***return***REMOVED***import('../dist/node/cli.js')
}

if***REMOVED***(profileIndex***REMOVED***>***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED***process.argv.splice(profileIndex,***REMOVED***1)
***REMOVED******REMOVED***const***REMOVED***next***REMOVED***=***REMOVED***process.argv[profileIndex]
***REMOVED******REMOVED***if***REMOVED***(next***REMOVED***&&***REMOVED***!next.startsWith('-'))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***process.argv.splice(profileIndex,***REMOVED***1)
***REMOVED******REMOVED***}
***REMOVED******REMOVED***const***REMOVED***inspector***REMOVED***=***REMOVED***await***REMOVED***import('node:inspector').then((r)***REMOVED***=>***REMOVED***r.default)
***REMOVED******REMOVED***const***REMOVED***session***REMOVED***=***REMOVED***(global.__vite_profile_session***REMOVED***=***REMOVED***new***REMOVED***inspector.Session())
***REMOVED******REMOVED***session.connect()
***REMOVED******REMOVED***session.post('Profiler.enable',***REMOVED***()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***session.post('Profiler.start',***REMOVED***start)
***REMOVED******REMOVED***})
}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED***start()
}
