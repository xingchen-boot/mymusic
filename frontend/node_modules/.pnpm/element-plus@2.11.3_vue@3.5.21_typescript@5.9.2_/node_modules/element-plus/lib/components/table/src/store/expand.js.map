{"version":3,"file":"expand.js","sources":["../../../../../../../packages/components/table/src/store/expand.ts"],"sourcesContent":["import***REMOVED***{***REMOVED***getCurrentInstance,***REMOVED***ref***REMOVED***}***REMOVED***from***REMOVED***'vue'\nimport***REMOVED***{***REMOVED***getKeysMap,***REMOVED***getRowIdentity,***REMOVED***toggleRowStatus***REMOVED***}***REMOVED***from***REMOVED***'../util'\n\nimport***REMOVED***type***REMOVED***{***REMOVED***Ref***REMOVED***}***REMOVED***from***REMOVED***'vue'\nimport***REMOVED***type***REMOVED***{***REMOVED***WatcherPropsData***REMOVED***}***REMOVED***from***REMOVED***'.'\nimport***REMOVED***type***REMOVED***{***REMOVED***DefaultRow,***REMOVED***Table***REMOVED***}***REMOVED***from***REMOVED***'../table/defaults'\n\nfunction***REMOVED***useExpand<T***REMOVED***extends***REMOVED***DefaultRow>(watcherData:***REMOVED***WatcherPropsData<T>)***REMOVED***{\n***REMOVED******REMOVED***const***REMOVED***instance***REMOVED***=***REMOVED***getCurrentInstance()***REMOVED***as***REMOVED***Table<T>\n***REMOVED******REMOVED***const***REMOVED***defaultExpandAll***REMOVED***=***REMOVED***ref(false)\n***REMOVED******REMOVED***const***REMOVED***expandRows:***REMOVED***Ref<T[]>***REMOVED***=***REMOVED***ref([])\n***REMOVED******REMOVED***const***REMOVED***updateExpandRows***REMOVED***=***REMOVED***()***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***data***REMOVED***=***REMOVED***watcherData.data.value***REMOVED***||***REMOVED***[]\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rowKey***REMOVED***=***REMOVED***watcherData.rowKey.value\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(defaultExpandAll.value)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expandRows.value***REMOVED***=***REMOVED***data.slice()\n***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***if***REMOVED***(rowKey)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***TODO：这里的代码可以优化\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***expandRowsMap***REMOVED***=***REMOVED***getKeysMap(expandRows.value,***REMOVED***rowKey)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expandRows.value***REMOVED***=***REMOVED***data.reduce((prev:***REMOVED***T[],***REMOVED***row:***REMOVED***T)***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rowId***REMOVED***=***REMOVED***getRowIdentity(row,***REMOVED***rowKey)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rowInfo***REMOVED***=***REMOVED***expandRowsMap[rowId]\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(rowInfo)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***prev.push(row)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***prev\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***},***REMOVED***[])\n***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expandRows.value***REMOVED***=***REMOVED***[]\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***const***REMOVED***toggleRowExpansion***REMOVED***=***REMOVED***(row:***REMOVED***T,***REMOVED***expanded?:***REMOVED***boolean)***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***changed***REMOVED***=***REMOVED***toggleRowStatus(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expandRows.value,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***row,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expanded,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***undefined,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***undefined,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***undefined,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***watcherData.rowKey.value\n***REMOVED******REMOVED******REMOVED******REMOVED***)\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(changed)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***instance.emit('expand-change',***REMOVED***row,***REMOVED***expandRows.value.slice())\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***const***REMOVED***setExpandRowKeys***REMOVED***=***REMOVED***(rowKeys:***REMOVED***(string***REMOVED***|***REMOVED***number)[])***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***instance.store.assertRowKey()\n***REMOVED******REMOVED******REMOVED******REMOVED***//***REMOVED***TODO：这里的代码可以优化\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***data***REMOVED***=***REMOVED***watcherData.data.value***REMOVED***||***REMOVED***[]\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rowKey***REMOVED***=***REMOVED***watcherData.rowKey.value\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***keysMap***REMOVED***=***REMOVED***getKeysMap(data,***REMOVED***rowKey)\n***REMOVED******REMOVED******REMOVED******REMOVED***expandRows.value***REMOVED***=***REMOVED***rowKeys.reduce((prev:***REMOVED***T[],***REMOVED***cur)***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***info***REMOVED***=***REMOVED***keysMap[cur]\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(info)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***prev.push(info.row)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***prev\n***REMOVED******REMOVED******REMOVED******REMOVED***},***REMOVED***[])\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***const***REMOVED***isRowExpanded***REMOVED***=***REMOVED***(row:***REMOVED***T):***REMOVED***boolean***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rowKey***REMOVED***=***REMOVED***watcherData.rowKey.value\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(rowKey)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***expandMap***REMOVED***=***REMOVED***getKeysMap(expandRows.value,***REMOVED***rowKey)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***!!expandMap[getRowIdentity(row,***REMOVED***rowKey)]\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***expandRows.value.includes(row)\n***REMOVED******REMOVED***}\n***REMOVED******REMOVED***return***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***updateExpandRows,\n***REMOVED******REMOVED******REMOVED******REMOVED***toggleRowExpansion,\n***REMOVED******REMOVED******REMOVED******REMOVED***setExpandRowKeys,\n***REMOVED******REMOVED******REMOVED******REMOVED***isRowExpanded,\n***REMOVED******REMOVED******REMOVED******REMOVED***states:***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expandRows,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***defaultExpandAll,\n***REMOVED******REMOVED******REMOVED******REMOVED***},\n***REMOVED******REMOVED***}\n}\n\nexport***REMOVED***default***REMOVED***useExpand\n"],"names":["getCurrentInstance","ref","getKeysMap","getRowIdentity","toggleRowStatus"],"mappings":"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"}