import***REMOVED***{***REMOVED***getCurrentInstance,***REMOVED***inject,***REMOVED***ref,***REMOVED***unref,***REMOVED***watch***REMOVED***}***REMOVED***from***REMOVED***'vue';
import***REMOVED***dayjs***REMOVED***from***REMOVED***'dayjs';
import***REMOVED***{***REMOVED***isEqual***REMOVED***}***REMOVED***from***REMOVED***'lodash-unified';
import***REMOVED***{***REMOVED***isValidRange,***REMOVED***getDefaultValue***REMOVED***}***REMOVED***from***REMOVED***'../utils.mjs';
import***REMOVED***{***REMOVED***ROOT_PICKER_INJECTION_KEY***REMOVED***}***REMOVED***from***REMOVED***'../constants.mjs';
import***REMOVED***{***REMOVED***useShortcut***REMOVED***}***REMOVED***from***REMOVED***'./use-shortcut.mjs';
import***REMOVED***{***REMOVED***useNamespace***REMOVED***}***REMOVED***from***REMOVED***'../../../../hooks/use-namespace/index.mjs';
import***REMOVED***{***REMOVED***useLocale***REMOVED***}***REMOVED***from***REMOVED***'../../../../hooks/use-locale/index.mjs';
import***REMOVED***{***REMOVED***isArray***REMOVED***}***REMOVED***from***REMOVED***'@vue/shared';

const***REMOVED***useRangePicker***REMOVED***=***REMOVED***(props,***REMOVED***{
***REMOVED******REMOVED***defaultValue,
***REMOVED******REMOVED***defaultTime,
***REMOVED******REMOVED***leftDate,
***REMOVED******REMOVED***rightDate,
***REMOVED******REMOVED***step,
***REMOVED******REMOVED***unit,
***REMOVED******REMOVED***sortDates
})***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***{***REMOVED***emit***REMOVED***}***REMOVED***=***REMOVED***getCurrentInstance();
***REMOVED******REMOVED***const***REMOVED***{***REMOVED***pickerNs***REMOVED***}***REMOVED***=***REMOVED***inject(ROOT_PICKER_INJECTION_KEY);
***REMOVED******REMOVED***const***REMOVED***drpNs***REMOVED***=***REMOVED***useNamespace("date-range-picker");
***REMOVED******REMOVED***const***REMOVED***{***REMOVED***t,***REMOVED***lang***REMOVED***}***REMOVED***=***REMOVED***useLocale();
***REMOVED******REMOVED***const***REMOVED***handleShortcutClick***REMOVED***=***REMOVED***useShortcut(lang);
***REMOVED******REMOVED***const***REMOVED***minDate***REMOVED***=***REMOVED***ref();
***REMOVED******REMOVED***const***REMOVED***maxDate***REMOVED***=***REMOVED***ref();
***REMOVED******REMOVED***const***REMOVED***rangeState***REMOVED***=***REMOVED***ref({
***REMOVED******REMOVED******REMOVED******REMOVED***endDate:***REMOVED***null,
***REMOVED******REMOVED******REMOVED******REMOVED***selecting:***REMOVED***false
***REMOVED******REMOVED***});
***REMOVED******REMOVED***const***REMOVED***handleChangeRange***REMOVED***=***REMOVED***(val)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***rangeState.value***REMOVED***=***REMOVED***val;
***REMOVED******REMOVED***};
***REMOVED******REMOVED***const***REMOVED***handleRangeConfirm***REMOVED***=***REMOVED***(visible***REMOVED***=***REMOVED***false)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***_minDate***REMOVED***=***REMOVED***unref(minDate);
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***_maxDate***REMOVED***=***REMOVED***unref(maxDate);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isValidRange([_minDate,***REMOVED***_maxDate]))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***emit("pick",***REMOVED***[_minDate,***REMOVED***_maxDate],***REMOVED***visible);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***};
***REMOVED******REMOVED***const***REMOVED***onSelect***REMOVED***=***REMOVED***(selecting)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***rangeState.value.selecting***REMOVED***=***REMOVED***selecting;
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!selecting)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rangeState.value.endDate***REMOVED***=***REMOVED***null;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***};
***REMOVED******REMOVED***const***REMOVED***parseValue***REMOVED***=***REMOVED***(parsedValue)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isArray(parsedValue)***REMOVED***&&***REMOVED***parsedValue.length***REMOVED***===***REMOVED***2)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***[start,***REMOVED***end]***REMOVED***=***REMOVED***parsedValue;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***minDate.value***REMOVED***=***REMOVED***start;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***leftDate.value***REMOVED***=***REMOVED***start;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***maxDate.value***REMOVED***=***REMOVED***end;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***sortDates(unref(minDate),***REMOVED***unref(maxDate));
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***restoreDefault();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***};
***REMOVED******REMOVED***const***REMOVED***restoreDefault***REMOVED***=***REMOVED***()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***[start,***REMOVED***end]***REMOVED***=***REMOVED***getDefaultValue(unref(defaultValue),***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***lang:***REMOVED***unref(lang),
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***step,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***unit,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***unlinkPanels:***REMOVED***props.unlinkPanels
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***getShift***REMOVED***=***REMOVED***(day)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***day.diff(day.startOf("d"),***REMOVED***"ms");
***REMOVED******REMOVED******REMOVED******REMOVED***};
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***maybeTimes***REMOVED***=***REMOVED***unref(defaultTime);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(maybeTimes)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***leftShift***REMOVED***=***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***rightShift***REMOVED***=***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isArray(maybeTimes))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***[timeStart,***REMOVED***timeEnd]***REMOVED***=***REMOVED***maybeTimes.map(dayjs);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***leftShift***REMOVED***=***REMOVED***getShift(timeStart);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rightShift***REMOVED***=***REMOVED***getShift(timeEnd);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***shift***REMOVED***=***REMOVED***getShift(dayjs(maybeTimes));
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***leftShift***REMOVED***=***REMOVED***shift;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rightShift***REMOVED***=***REMOVED***shift;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***start***REMOVED***=***REMOVED***start.startOf("d").add(leftShift,***REMOVED***"ms");
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***end***REMOVED***=***REMOVED***end.startOf("d").add(rightShift,***REMOVED***"ms");
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***minDate.value***REMOVED***=***REMOVED***void***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED***maxDate.value***REMOVED***=***REMOVED***void***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED***leftDate.value***REMOVED***=***REMOVED***start;
***REMOVED******REMOVED******REMOVED******REMOVED***rightDate.value***REMOVED***=***REMOVED***end;
***REMOVED******REMOVED***};
***REMOVED******REMOVED***watch(defaultValue,***REMOVED***(val)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(val)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***restoreDefault();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***},***REMOVED***{***REMOVED***immediate:***REMOVED***true***REMOVED***});
***REMOVED******REMOVED***watch(()***REMOVED***=>***REMOVED***props.parsedValue,***REMOVED***(parsedValue)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!(parsedValue***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***parsedValue.length)***REMOVED***||***REMOVED***!isEqual(parsedValue,***REMOVED***[minDate.value,***REMOVED***maxDate.value]))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***parseValue(parsedValue);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***},***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***immediate:***REMOVED***true
***REMOVED******REMOVED***});
***REMOVED******REMOVED***watch(()***REMOVED***=>***REMOVED***props.visible,***REMOVED***()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(props.visible)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***parseValue(props.parsedValue);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***},***REMOVED***{***REMOVED***immediate:***REMOVED***true***REMOVED***});
***REMOVED******REMOVED***return***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***minDate,
***REMOVED******REMOVED******REMOVED******REMOVED***maxDate,
***REMOVED******REMOVED******REMOVED******REMOVED***rangeState,
***REMOVED******REMOVED******REMOVED******REMOVED***lang,
***REMOVED******REMOVED******REMOVED******REMOVED***ppNs:***REMOVED***pickerNs,
***REMOVED******REMOVED******REMOVED******REMOVED***drpNs,
***REMOVED******REMOVED******REMOVED******REMOVED***handleChangeRange,
***REMOVED******REMOVED******REMOVED******REMOVED***handleRangeConfirm,
***REMOVED******REMOVED******REMOVED******REMOVED***handleShortcutClick,
***REMOVED******REMOVED******REMOVED******REMOVED***onSelect,
***REMOVED******REMOVED******REMOVED******REMOVED***parseValue,
***REMOVED******REMOVED******REMOVED******REMOVED***t
***REMOVED******REMOVED***};
};

export***REMOVED***{***REMOVED***useRangePicker***REMOVED***};
//#***REMOVED***sourceMappingURL=use-range-picker.mjs.map
