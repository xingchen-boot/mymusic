import***REMOVED***{***REMOVED***onMounted,***REMOVED***onUpdated***REMOVED***}***REMOVED***from***REMOVED***'vue';
import***REMOVED***{***REMOVED***useEventListener***REMOVED***}***REMOVED***from***REMOVED***'@vueuse/core';
import***REMOVED***{***REMOVED***useNamespace***REMOVED***}***REMOVED***from***REMOVED***'../../../../hooks/use-namespace/index.mjs';
import***REMOVED***{***REMOVED***EVENT_CODE***REMOVED***}***REMOVED***from***REMOVED***'../../../../constants/aria.mjs';

function***REMOVED***useKeydown({***REMOVED***el$***REMOVED***},***REMOVED***store)***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***ns***REMOVED***=***REMOVED***useNamespace("tree");
***REMOVED******REMOVED***onMounted(()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***initTabIndex();
***REMOVED******REMOVED***});
***REMOVED******REMOVED***onUpdated(()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***checkboxItems***REMOVED***=***REMOVED***Array.from(el$.value.querySelectorAll("input[type=checkbox]"));
***REMOVED******REMOVED******REMOVED******REMOVED***checkboxItems.forEach((checkbox)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***checkbox.setAttribute("tabindex",***REMOVED***"-1");
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED***});
***REMOVED******REMOVED***function***REMOVED***canNodeFocus(treeItems,***REMOVED***nextIndex)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***_a,***REMOVED***_b;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***currentNode***REMOVED***=***REMOVED***store.value.getNode(treeItems[nextIndex].dataset.key);
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***currentNode.canFocus***REMOVED***&&***REMOVED***currentNode.visible***REMOVED***&&***REMOVED***(((_a***REMOVED***=***REMOVED***currentNode.parent)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_a.expanded)***REMOVED***||***REMOVED***((_b***REMOVED***=***REMOVED***currentNode.parent)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_b.level)***REMOVED***===***REMOVED***0);
***REMOVED******REMOVED***}
***REMOVED******REMOVED***const***REMOVED***handleKeydown***REMOVED***=***REMOVED***(ev)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***currentItem***REMOVED***=***REMOVED***ev.target;
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!currentItem.className.includes(ns.b("node")))
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***code***REMOVED***=***REMOVED***ev.code;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***treeItems***REMOVED***=***REMOVED***Array.from(el$.value.querySelectorAll(`.${ns.is("focusable")}[role=treeitem]`));
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***currentIndex***REMOVED***=***REMOVED***treeItems.indexOf(currentItem);
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***nextIndex;
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***([EVENT_CODE.up,***REMOVED***EVENT_CODE.down].includes(code))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***ev.preventDefault();
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(code***REMOVED***===***REMOVED***EVENT_CODE.up)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***currentIndex***REMOVED***===***REMOVED***-1***REMOVED***?***REMOVED***0***REMOVED***:***REMOVED***currentIndex***REMOVED***!==***REMOVED***0***REMOVED***?***REMOVED***currentIndex***REMOVED***-***REMOVED***1***REMOVED***:***REMOVED***treeItems.length***REMOVED***-***REMOVED***1;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***startIndex***REMOVED***=***REMOVED***nextIndex;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***while***REMOVED***(true)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(canNodeFocus(treeItems,***REMOVED***nextIndex))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex--;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(nextIndex***REMOVED***===***REMOVED***startIndex)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***-1;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(nextIndex***REMOVED***<***REMOVED***0)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***treeItems.length***REMOVED***-***REMOVED***1;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***currentIndex***REMOVED***===***REMOVED***-1***REMOVED***?***REMOVED***0***REMOVED***:***REMOVED***currentIndex***REMOVED***<***REMOVED***treeItems.length***REMOVED***-***REMOVED***1***REMOVED***?***REMOVED***currentIndex***REMOVED***+***REMOVED***1***REMOVED***:***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***startIndex***REMOVED***=***REMOVED***nextIndex;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***while***REMOVED***(true)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(canNodeFocus(treeItems,***REMOVED***nextIndex))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex++;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(nextIndex***REMOVED***===***REMOVED***startIndex)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***-1;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(nextIndex***REMOVED***>=***REMOVED***treeItems.length)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***=***REMOVED***0;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextIndex***REMOVED***!==***REMOVED***-1***REMOVED***&&***REMOVED***treeItems[nextIndex].focus();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***([EVENT_CODE.left,***REMOVED***EVENT_CODE.right].includes(code))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***ev.preventDefault();
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***currentItem.click();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***hasInput***REMOVED***=***REMOVED***currentItem.querySelector('[type="checkbox"]');
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***([EVENT_CODE.enter,***REMOVED***EVENT_CODE.numpadEnter,***REMOVED***EVENT_CODE.space].includes(code)***REMOVED***&&***REMOVED***hasInput)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***ev.preventDefault();
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***hasInput.click();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***};
***REMOVED******REMOVED***useEventListener(el$,***REMOVED***"keydown",***REMOVED***handleKeydown);
***REMOVED******REMOVED***const***REMOVED***initTabIndex***REMOVED***=***REMOVED***()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***_a;
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!el$.value)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***treeItems***REMOVED***=***REMOVED***Array.from(el$.value.querySelectorAll(`.${ns.is("focusable")}[role=treeitem]`));
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***checkboxItems***REMOVED***=***REMOVED***Array.from(el$.value.querySelectorAll("input[type=checkbox]"));
***REMOVED******REMOVED******REMOVED******REMOVED***checkboxItems.forEach((checkbox)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***checkbox.setAttribute("tabindex",***REMOVED***"-1");
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***checkedItem***REMOVED***=***REMOVED***el$.value.querySelectorAll(`.${ns.is("checked")}[role=treeitem]`);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(checkedItem.length)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***checkedItem[0].setAttribute("tabindex",***REMOVED***"0");
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***(_a***REMOVED***=***REMOVED***treeItems[0])***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_a.setAttribute("tabindex",***REMOVED***"0");
***REMOVED******REMOVED***};
}

export***REMOVED***{***REMOVED***useKeydown***REMOVED***};
//#***REMOVED***sourceMappingURL=useKeydown.mjs.map
