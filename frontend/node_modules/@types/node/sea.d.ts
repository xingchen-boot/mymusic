/**
***REMOVED*******REMOVED***This***REMOVED***feature***REMOVED***allows***REMOVED***the***REMOVED***distribution***REMOVED***of***REMOVED***a***REMOVED***Node.js***REMOVED***application***REMOVED***conveniently***REMOVED***to***REMOVED***a
***REMOVED*******REMOVED***system***REMOVED***that***REMOVED***does***REMOVED***not***REMOVED***have***REMOVED***Node.js***REMOVED***installed.
***REMOVED****
***REMOVED*******REMOVED***Node.js***REMOVED***supports***REMOVED***the***REMOVED***creation***REMOVED***of***REMOVED***[single***REMOVED***executable***REMOVED***applications](https://github.com/nodejs/single-executable)***REMOVED***by***REMOVED***allowing
***REMOVED*******REMOVED***the***REMOVED***injection***REMOVED***of***REMOVED***a***REMOVED***blob***REMOVED***prepared***REMOVED***by***REMOVED***Node.js,***REMOVED***which***REMOVED***can***REMOVED***contain***REMOVED***a***REMOVED***bundled***REMOVED***script,
***REMOVED*******REMOVED***into***REMOVED***the***REMOVED***`node`***REMOVED***binary.***REMOVED***During***REMOVED***start***REMOVED***up,***REMOVED***the***REMOVED***program***REMOVED***checks***REMOVED***if***REMOVED***anything***REMOVED***has***REMOVED***been
***REMOVED*******REMOVED***injected.***REMOVED***If***REMOVED***the***REMOVED***blob***REMOVED***is***REMOVED***found,***REMOVED***it***REMOVED***executes***REMOVED***the***REMOVED***script***REMOVED***in***REMOVED***the***REMOVED***blob.***REMOVED***Otherwise
***REMOVED*******REMOVED***Node.js***REMOVED***operates***REMOVED***as***REMOVED***it***REMOVED***normally***REMOVED***does.
***REMOVED****
***REMOVED*******REMOVED***The***REMOVED***single***REMOVED***executable***REMOVED***application***REMOVED***feature***REMOVED***currently***REMOVED***only***REMOVED***supports***REMOVED***running***REMOVED***a
***REMOVED*******REMOVED***single***REMOVED***embedded***REMOVED***script***REMOVED***using***REMOVED***the***REMOVED***`CommonJS`***REMOVED***module***REMOVED***system.
***REMOVED****
***REMOVED*******REMOVED***Users***REMOVED***can***REMOVED***create***REMOVED***a***REMOVED***single***REMOVED***executable***REMOVED***application***REMOVED***from***REMOVED***their***REMOVED***bundled***REMOVED***script
***REMOVED*******REMOVED***with***REMOVED***the***REMOVED***`node`***REMOVED***binary***REMOVED***itself***REMOVED***and***REMOVED***any***REMOVED***tool***REMOVED***which***REMOVED***can***REMOVED***inject***REMOVED***resources***REMOVED***into***REMOVED***the
***REMOVED*******REMOVED***binary.
***REMOVED****
***REMOVED*******REMOVED***Here***REMOVED***are***REMOVED***the***REMOVED***steps***REMOVED***for***REMOVED***creating***REMOVED***a***REMOVED***single***REMOVED***executable***REMOVED***application***REMOVED***using***REMOVED***one***REMOVED***such
***REMOVED*******REMOVED***tool,***REMOVED***[postject](https://github.com/nodejs/postject):
***REMOVED****
***REMOVED*******REMOVED***1.***REMOVED***Create***REMOVED***a***REMOVED***JavaScript***REMOVED***file:
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***echo***REMOVED***'console.log(`Hello,***REMOVED***${process.argv[2]}!`);'***REMOVED***>***REMOVED***hello.js
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***2.***REMOVED***Create***REMOVED***a***REMOVED***configuration***REMOVED***file***REMOVED***building***REMOVED***a***REMOVED***blob***REMOVED***that***REMOVED***can***REMOVED***be***REMOVED***injected***REMOVED***into***REMOVED***the
***REMOVED*******REMOVED***single***REMOVED***executable***REMOVED***application***REMOVED***(see***REMOVED***`Generating***REMOVED***single***REMOVED***executable***REMOVED***preparation***REMOVED***blobs`***REMOVED***for***REMOVED***details):
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***echo***REMOVED***'{***REMOVED***"main":***REMOVED***"hello.js",***REMOVED***"output":***REMOVED***"sea-prep.blob"***REMOVED***}'***REMOVED***>***REMOVED***sea-config.json
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***3.***REMOVED***Generate***REMOVED***the***REMOVED***blob***REMOVED***to***REMOVED***be***REMOVED***injected:
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***node***REMOVED***--experimental-sea-config***REMOVED***sea-config.json
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***4.***REMOVED***Create***REMOVED***a***REMOVED***copy***REMOVED***of***REMOVED***the***REMOVED***`node`***REMOVED***executable***REMOVED***and***REMOVED***name***REMOVED***it***REMOVED***according***REMOVED***to***REMOVED***your***REMOVED***needs:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***systems***REMOVED***other***REMOVED***than***REMOVED***Windows:
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***cp***REMOVED***$(command***REMOVED***-v***REMOVED***node)***REMOVED***hello
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows:
***REMOVED*******REMOVED***```text
***REMOVED*******REMOVED***node***REMOVED***-e***REMOVED***"require('fs').copyFileSync(process.execPath,***REMOVED***'hello.exe')"
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***The***REMOVED***`.exe`***REMOVED***extension***REMOVED***is***REMOVED***necessary.
***REMOVED*******REMOVED***5.***REMOVED***Remove***REMOVED***the***REMOVED***signature***REMOVED***of***REMOVED***the***REMOVED***binary***REMOVED***(macOS***REMOVED***and***REMOVED***Windows***REMOVED***only):
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***macOS:
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***codesign***REMOVED***--remove-signature***REMOVED***hello
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows***REMOVED***(optional):
***REMOVED*******REMOVED***[signtool](https://learn.microsoft.com/en-us/windows/win32/seccrypto/signtool)***REMOVED***can***REMOVED***be***REMOVED***used***REMOVED***from***REMOVED***the***REMOVED***installed***REMOVED***[Windows***REMOVED***SDK](https://developer.microsoft.com/en-us/windows/downloads/windows-sdk/).
***REMOVED*******REMOVED***If***REMOVED***this***REMOVED***step***REMOVED***is
***REMOVED*******REMOVED***skipped,***REMOVED***ignore***REMOVED***any***REMOVED***signature-related***REMOVED***warning***REMOVED***from***REMOVED***postject.
***REMOVED*******REMOVED***```powershell
***REMOVED*******REMOVED***signtool***REMOVED***remove***REMOVED***/s***REMOVED***hello.exe
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***6.***REMOVED***Inject***REMOVED***the***REMOVED***blob***REMOVED***into***REMOVED***the***REMOVED***copied***REMOVED***binary***REMOVED***by***REMOVED***running***REMOVED***`postject`***REMOVED***with
***REMOVED*******REMOVED***the***REMOVED***following***REMOVED***options:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***`hello`***REMOVED***/***REMOVED***`hello.exe`***REMOVED***\-***REMOVED***The***REMOVED***name***REMOVED***of***REMOVED***the***REMOVED***copy***REMOVED***of***REMOVED***the***REMOVED***`node`***REMOVED***executable
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***created***REMOVED***in***REMOVED***step***REMOVED***4.
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***`NODE_SEA_BLOB`***REMOVED***\-***REMOVED***The***REMOVED***name***REMOVED***of***REMOVED***the***REMOVED***resource***REMOVED***/***REMOVED***note***REMOVED***/***REMOVED***section***REMOVED***in***REMOVED***the***REMOVED***binary
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***where***REMOVED***the***REMOVED***contents***REMOVED***of***REMOVED***the***REMOVED***blob***REMOVED***will***REMOVED***be***REMOVED***stored.
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***`sea-prep.blob`***REMOVED***\-***REMOVED***The***REMOVED***name***REMOVED***of***REMOVED***the***REMOVED***blob***REMOVED***created***REMOVED***in***REMOVED***step***REMOVED***1.
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***`--sentinel-fuse***REMOVED***NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2`***REMOVED***\-***REMOVED***The***REMOVED***[fuse](https://www.electronjs.org/docs/latest/tutorial/fuses)***REMOVED***used***REMOVED***by***REMOVED***the***REMOVED***Node.js***REMOVED***project***REMOVED***to***REMOVED***detect***REMOVED***if***REMOVED***a***REMOVED***file***REMOVED***has***REMOVED***been
***REMOVED*******REMOVED***injected.
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***`--macho-segment-name***REMOVED***NODE_SEA`***REMOVED***(only***REMOVED***needed***REMOVED***on***REMOVED***macOS)***REMOVED***-***REMOVED***The***REMOVED***name***REMOVED***of***REMOVED***the
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***segment***REMOVED***in***REMOVED***the***REMOVED***binary***REMOVED***where***REMOVED***the***REMOVED***contents***REMOVED***of***REMOVED***the***REMOVED***blob***REMOVED***will***REMOVED***be
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***stored.
***REMOVED*******REMOVED***To***REMOVED***summarize,***REMOVED***here***REMOVED***is***REMOVED***the***REMOVED***required***REMOVED***command***REMOVED***for***REMOVED***each***REMOVED***platform:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Linux:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```bash
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***npx***REMOVED***postject***REMOVED***hello***REMOVED***NODE_SEA_BLOB***REMOVED***sea-prep.blob***REMOVED***\
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***--sentinel-fuse***REMOVED***NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows***REMOVED***-***REMOVED***PowerShell:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```powershell
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***npx***REMOVED***postject***REMOVED***hello.exe***REMOVED***NODE_SEA_BLOB***REMOVED***sea-prep.blob***REMOVED***`
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***--sentinel-fuse***REMOVED***NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows***REMOVED***-***REMOVED***Command***REMOVED***Prompt:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```text
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***npx***REMOVED***postject***REMOVED***hello.exe***REMOVED***NODE_SEA_BLOB***REMOVED***sea-prep.blob***REMOVED***^
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***--sentinel-fuse***REMOVED***NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***macOS:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```bash
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***npx***REMOVED***postject***REMOVED***hello***REMOVED***NODE_SEA_BLOB***REMOVED***sea-prep.blob***REMOVED***\
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***--sentinel-fuse***REMOVED***NODE_SEA_FUSE_fce680ab2cc467b6e072b8b5df1996b2***REMOVED***\
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***--macho-segment-name***REMOVED***NODE_SEA
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED***```
***REMOVED*******REMOVED***7.***REMOVED***Sign***REMOVED***the***REMOVED***binary***REMOVED***(macOS***REMOVED***and***REMOVED***Windows***REMOVED***only):
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***macOS:
***REMOVED*******REMOVED***```bash
***REMOVED*******REMOVED***codesign***REMOVED***--sign***REMOVED***-***REMOVED***hello
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows***REMOVED***(optional):
***REMOVED*******REMOVED***A***REMOVED***certificate***REMOVED***needs***REMOVED***to***REMOVED***be***REMOVED***present***REMOVED***for***REMOVED***this***REMOVED***to***REMOVED***work.***REMOVED***However,***REMOVED***the***REMOVED***unsigned
***REMOVED*******REMOVED***binary***REMOVED***would***REMOVED***still***REMOVED***be***REMOVED***runnable.
***REMOVED*******REMOVED***```powershell
***REMOVED*******REMOVED***signtool***REMOVED***sign***REMOVED***/fd***REMOVED***SHA256***REMOVED***hello.exe
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***8.***REMOVED***Run***REMOVED***the***REMOVED***binary:
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***systems***REMOVED***other***REMOVED***than***REMOVED***Windows
***REMOVED*******REMOVED***```console
***REMOVED*******REMOVED***$***REMOVED***./hello***REMOVED***world
***REMOVED*******REMOVED***Hello,***REMOVED***world!
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***On***REMOVED***Windows
***REMOVED*******REMOVED***```console
***REMOVED*******REMOVED***$***REMOVED***.\hello.exe***REMOVED***world
***REMOVED*******REMOVED***Hello,***REMOVED***world!
***REMOVED*******REMOVED***```
***REMOVED*******REMOVED***@since***REMOVED***v19.7.0,***REMOVED***v18.16.0
***REMOVED*******REMOVED***@experimental
***REMOVED*******REMOVED***@see***REMOVED***[source](https://github.com/nodejs/node/blob/v20.12.0/src/node_sea.cc)
***REMOVED****/
declare***REMOVED***module***REMOVED***"node:sea"***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***type***REMOVED***AssetKey***REMOVED***=***REMOVED***string;
***REMOVED******REMOVED******REMOVED******REMOVED***/**
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***@since***REMOVED***v20.12.0
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***@return***REMOVED***Whether***REMOVED***this***REMOVED***script***REMOVED***is***REMOVED***running***REMOVED***inside***REMOVED***a***REMOVED***single-executable***REMOVED***application.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****/
***REMOVED******REMOVED******REMOVED******REMOVED***function***REMOVED***isSea():***REMOVED***boolean;
***REMOVED******REMOVED******REMOVED******REMOVED***/**
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***This***REMOVED***method***REMOVED***can***REMOVED***be***REMOVED***used***REMOVED***to***REMOVED***retrieve***REMOVED***the***REMOVED***assets***REMOVED***configured***REMOVED***to***REMOVED***be***REMOVED***bundled***REMOVED***into***REMOVED***the
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***single-executable***REMOVED***application***REMOVED***at***REMOVED***build***REMOVED***time.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***An***REMOVED***error***REMOVED***is***REMOVED***thrown***REMOVED***when***REMOVED***no***REMOVED***matching***REMOVED***asset***REMOVED***can***REMOVED***be***REMOVED***found.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***@since***REMOVED***v20.12.0
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****/
***REMOVED******REMOVED******REMOVED******REMOVED***function***REMOVED***getAsset(key:***REMOVED***AssetKey):***REMOVED***ArrayBuffer;
***REMOVED******REMOVED******REMOVED******REMOVED***function***REMOVED***getAsset(key:***REMOVED***AssetKey,***REMOVED***encoding:***REMOVED***string):***REMOVED***string;
***REMOVED******REMOVED******REMOVED******REMOVED***/**
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***Similar***REMOVED***to***REMOVED***`sea.getAsset()`,***REMOVED***but***REMOVED***returns***REMOVED***the***REMOVED***result***REMOVED***in***REMOVED***a***REMOVED***[`Blob`](https://developer.mozilla.org/en-US/docs/Web/API/Blob).
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***An***REMOVED***error***REMOVED***is***REMOVED***thrown***REMOVED***when***REMOVED***no***REMOVED***matching***REMOVED***asset***REMOVED***can***REMOVED***be***REMOVED***found.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***@since***REMOVED***v20.12.0
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****/
***REMOVED******REMOVED******REMOVED******REMOVED***function***REMOVED***getAssetAsBlob(key:***REMOVED***AssetKey,***REMOVED***options?:***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***type:***REMOVED***string;
***REMOVED******REMOVED******REMOVED******REMOVED***}):***REMOVED***Blob;
***REMOVED******REMOVED******REMOVED******REMOVED***/**
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***This***REMOVED***method***REMOVED***can***REMOVED***be***REMOVED***used***REMOVED***to***REMOVED***retrieve***REMOVED***the***REMOVED***assets***REMOVED***configured***REMOVED***to***REMOVED***be***REMOVED***bundled***REMOVED***into***REMOVED***the
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***single-executable***REMOVED***application***REMOVED***at***REMOVED***build***REMOVED***time.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***An***REMOVED***error***REMOVED***is***REMOVED***thrown***REMOVED***when***REMOVED***no***REMOVED***matching***REMOVED***asset***REMOVED***can***REMOVED***be***REMOVED***found.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***Unlike***REMOVED***`sea.getRawAsset()`***REMOVED***or***REMOVED***`sea.getAssetAsBlob()`,***REMOVED***this***REMOVED***method***REMOVED***does***REMOVED***not
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***return***REMOVED***a***REMOVED***copy.***REMOVED***Instead,***REMOVED***it***REMOVED***returns***REMOVED***the***REMOVED***raw***REMOVED***asset***REMOVED***bundled***REMOVED***inside***REMOVED***the***REMOVED***executable.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***For***REMOVED***now,***REMOVED***users***REMOVED***should***REMOVED***avoid***REMOVED***writing***REMOVED***to***REMOVED***the***REMOVED***returned***REMOVED***array***REMOVED***buffer.***REMOVED***If***REMOVED***the
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***injected***REMOVED***section***REMOVED***is***REMOVED***not***REMOVED***marked***REMOVED***as***REMOVED***writable***REMOVED***or***REMOVED***not***REMOVED***aligned***REMOVED***properly,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***writes***REMOVED***to***REMOVED***the***REMOVED***returned***REMOVED***array***REMOVED***buffer***REMOVED***is***REMOVED***likely***REMOVED***to***REMOVED***result***REMOVED***in***REMOVED***a***REMOVED***crash.
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED*******REMOVED***@since***REMOVED***v20.12.0
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED****/
***REMOVED******REMOVED******REMOVED******REMOVED***function***REMOVED***getRawAsset(key:***REMOVED***AssetKey):***REMOVED***string***REMOVED***|***REMOVED***ArrayBuffer;
}
