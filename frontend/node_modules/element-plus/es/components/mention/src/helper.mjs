import***REMOVED***{***REMOVED***castArray***REMOVED***}***REMOVED***from***REMOVED***'lodash-unified';
import***REMOVED***{***REMOVED***isFirefox***REMOVED***}***REMOVED***from***REMOVED***'../../../utils/browser.mjs';

const***REMOVED***filterOption***REMOVED***=***REMOVED***(pattern,***REMOVED***option)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***lowerCase***REMOVED***=***REMOVED***pattern.toLowerCase();
***REMOVED******REMOVED***const***REMOVED***label***REMOVED***=***REMOVED***option.label***REMOVED***||***REMOVED***option.value***REMOVED***||***REMOVED***"";
***REMOVED******REMOVED***return***REMOVED***label.toLowerCase().includes(lowerCase);
};
const***REMOVED***getMentionCtx***REMOVED***=***REMOVED***(inputEl,***REMOVED***prefix,***REMOVED***split)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***{***REMOVED***selectionEnd***REMOVED***}***REMOVED***=***REMOVED***inputEl;
***REMOVED******REMOVED***if***REMOVED***(selectionEnd***REMOVED***===***REMOVED***null)
***REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED***const***REMOVED***inputValue***REMOVED***=***REMOVED***inputEl.value;
***REMOVED******REMOVED***const***REMOVED***prefixArray***REMOVED***=***REMOVED***castArray(prefix);
***REMOVED******REMOVED***let***REMOVED***splitIndex***REMOVED***=***REMOVED***-1;
***REMOVED******REMOVED***let***REMOVED***mentionCtx;
***REMOVED******REMOVED***for***REMOVED***(let***REMOVED***i***REMOVED***=***REMOVED***selectionEnd***REMOVED***-***REMOVED***1;***REMOVED***i***REMOVED***>=***REMOVED***0;***REMOVED***--i)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***char***REMOVED***=***REMOVED***inputValue[i];
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(char***REMOVED***===***REMOVED***split***REMOVED***||***REMOVED***char***REMOVED***===***REMOVED***"\n"***REMOVED***||***REMOVED***char***REMOVED***===***REMOVED***"\r")***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***splitIndex***REMOVED***=***REMOVED***i;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***continue;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(prefixArray.includes(char))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***end***REMOVED***=***REMOVED***splitIndex***REMOVED***===***REMOVED***-1***REMOVED***?***REMOVED***selectionEnd***REMOVED***:***REMOVED***splitIndex;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***pattern***REMOVED***=***REMOVED***inputValue.slice(i***REMOVED***+***REMOVED***1,***REMOVED***end);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***mentionCtx***REMOVED***=***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***pattern,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***start:***REMOVED***i***REMOVED***+***REMOVED***1,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***end,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***prefix:***REMOVED***char,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***prefixIndex:***REMOVED***i,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***splitIndex,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***selectionEnd
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***};
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***break;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***return***REMOVED***mentionCtx;
};
const***REMOVED***getCursorPosition***REMOVED***=***REMOVED***(element,***REMOVED***options***REMOVED***=***REMOVED***{
***REMOVED******REMOVED***debug:***REMOVED***false,
***REMOVED******REMOVED***useSelectionEnd:***REMOVED***false
})***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***selectionStart***REMOVED***=***REMOVED***element.selectionStart***REMOVED***!==***REMOVED***null***REMOVED***?***REMOVED***element.selectionStart***REMOVED***:***REMOVED***0;
***REMOVED******REMOVED***const***REMOVED***selectionEnd***REMOVED***=***REMOVED***element.selectionEnd***REMOVED***!==***REMOVED***null***REMOVED***?***REMOVED***element.selectionEnd***REMOVED***:***REMOVED***0;
***REMOVED******REMOVED***const***REMOVED***position***REMOVED***=***REMOVED***options.useSelectionEnd***REMOVED***?***REMOVED***selectionEnd***REMOVED***:***REMOVED***selectionStart;
***REMOVED******REMOVED***const***REMOVED***properties***REMOVED***=***REMOVED***[
***REMOVED******REMOVED******REMOVED******REMOVED***"direction",
***REMOVED******REMOVED******REMOVED******REMOVED***"boxSizing",
***REMOVED******REMOVED******REMOVED******REMOVED***"width",
***REMOVED******REMOVED******REMOVED******REMOVED***"height",
***REMOVED******REMOVED******REMOVED******REMOVED***"overflowX",
***REMOVED******REMOVED******REMOVED******REMOVED***"overflowY",
***REMOVED******REMOVED******REMOVED******REMOVED***"borderTopWidth",
***REMOVED******REMOVED******REMOVED******REMOVED***"borderRightWidth",
***REMOVED******REMOVED******REMOVED******REMOVED***"borderBottomWidth",
***REMOVED******REMOVED******REMOVED******REMOVED***"borderLeftWidth",
***REMOVED******REMOVED******REMOVED******REMOVED***"borderStyle",
***REMOVED******REMOVED******REMOVED******REMOVED***"paddingTop",
***REMOVED******REMOVED******REMOVED******REMOVED***"paddingRight",
***REMOVED******REMOVED******REMOVED******REMOVED***"paddingBottom",
***REMOVED******REMOVED******REMOVED******REMOVED***"paddingLeft",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontStyle",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontVariant",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontWeight",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontStretch",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontSize",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontSizeAdjust",
***REMOVED******REMOVED******REMOVED******REMOVED***"lineHeight",
***REMOVED******REMOVED******REMOVED******REMOVED***"fontFamily",
***REMOVED******REMOVED******REMOVED******REMOVED***"textAlign",
***REMOVED******REMOVED******REMOVED******REMOVED***"textTransform",
***REMOVED******REMOVED******REMOVED******REMOVED***"textIndent",
***REMOVED******REMOVED******REMOVED******REMOVED***"textDecoration",
***REMOVED******REMOVED******REMOVED******REMOVED***"letterSpacing",
***REMOVED******REMOVED******REMOVED******REMOVED***"wordSpacing",
***REMOVED******REMOVED******REMOVED******REMOVED***"tabSize",
***REMOVED******REMOVED******REMOVED******REMOVED***"MozTabSize"
***REMOVED******REMOVED***];
***REMOVED******REMOVED***if***REMOVED***(options.debug)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***el***REMOVED***=***REMOVED***document.querySelector("#input-textarea-caret-position-mirror-div");
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(el***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***el.parentNode)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***el.parentNode.removeChild(el);
***REMOVED******REMOVED***}
***REMOVED******REMOVED***const***REMOVED***div***REMOVED***=***REMOVED***document.createElement("div");
***REMOVED******REMOVED***div.id***REMOVED***=***REMOVED***"input-textarea-caret-position-mirror-div";
***REMOVED******REMOVED***document.body.appendChild(div);
***REMOVED******REMOVED***const***REMOVED***style***REMOVED***=***REMOVED***div.style;
***REMOVED******REMOVED***const***REMOVED***computed***REMOVED***=***REMOVED***window.getComputedStyle(element);
***REMOVED******REMOVED***const***REMOVED***isInput***REMOVED***=***REMOVED***element.nodeName***REMOVED***===***REMOVED***"INPUT";
***REMOVED******REMOVED***style.whiteSpace***REMOVED***=***REMOVED***isInput***REMOVED***?***REMOVED***"nowrap"***REMOVED***:***REMOVED***"pre-wrap";
***REMOVED******REMOVED***if***REMOVED***(!isInput)
***REMOVED******REMOVED******REMOVED******REMOVED***style.wordWrap***REMOVED***=***REMOVED***"break-word";
***REMOVED******REMOVED***style.position***REMOVED***=***REMOVED***"absolute";
***REMOVED******REMOVED***if***REMOVED***(!options.debug)
***REMOVED******REMOVED******REMOVED******REMOVED***style.visibility***REMOVED***=***REMOVED***"hidden";
***REMOVED******REMOVED***properties.forEach((prop)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isInput***REMOVED***&&***REMOVED***prop***REMOVED***===***REMOVED***"lineHeight")***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(computed.boxSizing***REMOVED***===***REMOVED***"border-box")***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***height***REMOVED***=***REMOVED***Number.parseInt(computed.height);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***outerHeight***REMOVED***=***REMOVED***Number.parseInt(computed.paddingTop)***REMOVED***+***REMOVED***Number.parseInt(computed.paddingBottom)***REMOVED***+***REMOVED***Number.parseInt(computed.borderTopWidth)***REMOVED***+***REMOVED***Number.parseInt(computed.borderBottomWidth);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***targetHeight***REMOVED***=***REMOVED***outerHeight***REMOVED***+***REMOVED***Number.parseInt(computed.lineHeight);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(height***REMOVED***>***REMOVED***targetHeight)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style.lineHeight***REMOVED***=***REMOVED***`${height***REMOVED***-***REMOVED***outerHeight}px`;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***if***REMOVED***(height***REMOVED***===***REMOVED***targetHeight)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style.lineHeight***REMOVED***=***REMOVED***computed.lineHeight;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style.lineHeight***REMOVED***=***REMOVED***"0";
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style.lineHeight***REMOVED***=***REMOVED***computed.height;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style[prop]***REMOVED***=***REMOVED***computed[prop];
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***});
***REMOVED******REMOVED***if***REMOVED***(isFirefox())***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(element.scrollHeight***REMOVED***>***REMOVED***Number.parseInt(computed.height))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***style.overflowY***REMOVED***=***REMOVED***"scroll";
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***style.overflow***REMOVED***=***REMOVED***"hidden";
***REMOVED******REMOVED***}
***REMOVED******REMOVED***div.textContent***REMOVED***=***REMOVED***element.value.slice(0,***REMOVED***Math.max(0,***REMOVED***position));
***REMOVED******REMOVED***if***REMOVED***(isInput***REMOVED***&&***REMOVED***div.textContent)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***div.textContent***REMOVED***=***REMOVED***div.textContent.replace(/\s/g,***REMOVED***"\xA0");
***REMOVED******REMOVED***}
***REMOVED******REMOVED***const***REMOVED***span***REMOVED***=***REMOVED***document.createElement("span");
***REMOVED******REMOVED***span.textContent***REMOVED***=***REMOVED***element.value.slice(Math.max(0,***REMOVED***position))***REMOVED***||***REMOVED***".";
***REMOVED******REMOVED***span.style.position***REMOVED***=***REMOVED***"relative";
***REMOVED******REMOVED***span.style.left***REMOVED***=***REMOVED***`${-element.scrollLeft}px`;
***REMOVED******REMOVED***span.style.top***REMOVED***=***REMOVED***`${-element.scrollTop}px`;
***REMOVED******REMOVED***div.appendChild(span);
***REMOVED******REMOVED***const***REMOVED***relativePosition***REMOVED***=***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***top:***REMOVED***span.offsetTop***REMOVED***+***REMOVED***Number.parseInt(computed.borderTopWidth),
***REMOVED******REMOVED******REMOVED******REMOVED***left:***REMOVED***span.offsetLeft***REMOVED***+***REMOVED***Number.parseInt(computed.borderLeftWidth),
***REMOVED******REMOVED******REMOVED******REMOVED***height:***REMOVED***Number.parseInt(computed.fontSize)***REMOVED*******REMOVED***1.5
***REMOVED******REMOVED***};
***REMOVED******REMOVED***if***REMOVED***(options.debug)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***span.style.backgroundColor***REMOVED***=***REMOVED***"#aaa";
***REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***document.body.removeChild(div);
***REMOVED******REMOVED***}
***REMOVED******REMOVED***if***REMOVED***(relativePosition.left***REMOVED***>=***REMOVED***element.clientWidth)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***relativePosition.left***REMOVED***=***REMOVED***element.clientWidth;
***REMOVED******REMOVED***}
***REMOVED******REMOVED***return***REMOVED***relativePosition;
};

export***REMOVED***{***REMOVED***filterOption,***REMOVED***getCursorPosition,***REMOVED***getMentionCtx***REMOVED***};
//#***REMOVED***sourceMappingURL=helper.mjs.map
