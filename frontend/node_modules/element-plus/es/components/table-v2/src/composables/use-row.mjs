import***REMOVED***{***REMOVED***getCurrentInstance,***REMOVED***shallowRef,***REMOVED***ref,***REMOVED***computed,***REMOVED***unref,***REMOVED***nextTick***REMOVED***}***REMOVED***from***REMOVED***'vue';
import***REMOVED***{***REMOVED***debounce***REMOVED***}***REMOVED***from***REMOVED***'lodash-unified';
import***REMOVED***{***REMOVED***FixedDir***REMOVED***}***REMOVED***from***REMOVED***'../constants.mjs';
import***REMOVED***{***REMOVED***isNumber***REMOVED***}***REMOVED***from***REMOVED***'../../../../utils/types.mjs';

const***REMOVED***useRow***REMOVED***=***REMOVED***(props,***REMOVED***{
***REMOVED******REMOVED***mainTableRef,
***REMOVED******REMOVED***leftTableRef,
***REMOVED******REMOVED***rightTableRef,
***REMOVED******REMOVED***tableInstance,
***REMOVED******REMOVED***ns,
***REMOVED******REMOVED***isScrolling
})***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***vm***REMOVED***=***REMOVED***getCurrentInstance();
***REMOVED******REMOVED***const***REMOVED***{***REMOVED***emit***REMOVED***}***REMOVED***=***REMOVED***vm;
***REMOVED******REMOVED***const***REMOVED***isResetting***REMOVED***=***REMOVED***shallowRef(false);
***REMOVED******REMOVED***const***REMOVED***expandedRowKeys***REMOVED***=***REMOVED***ref(props.defaultExpandedRowKeys***REMOVED***||***REMOVED***[]);
***REMOVED******REMOVED***const***REMOVED***lastRenderedRowIndex***REMOVED***=***REMOVED***ref(-1);
***REMOVED******REMOVED***const***REMOVED***resetIndex***REMOVED***=***REMOVED***shallowRef(null);
***REMOVED******REMOVED***const***REMOVED***rowHeights***REMOVED***=***REMOVED***ref({});
***REMOVED******REMOVED***const***REMOVED***pendingRowHeights***REMOVED***=***REMOVED***ref({});
***REMOVED******REMOVED***const***REMOVED***leftTableHeights***REMOVED***=***REMOVED***shallowRef({});
***REMOVED******REMOVED***const***REMOVED***mainTableHeights***REMOVED***=***REMOVED***shallowRef({});
***REMOVED******REMOVED***const***REMOVED***rightTableHeights***REMOVED***=***REMOVED***shallowRef({});
***REMOVED******REMOVED***const***REMOVED***isDynamic***REMOVED***=***REMOVED***computed(()***REMOVED***=>***REMOVED***isNumber(props.estimatedRowHeight));
***REMOVED******REMOVED***function***REMOVED***onRowsRendered(params)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***_a;
***REMOVED******REMOVED******REMOVED******REMOVED***(_a***REMOVED***=***REMOVED***props.onRowsRendered)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_a.call(props,***REMOVED***params);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(params.rowCacheEnd***REMOVED***>***REMOVED***unref(lastRenderedRowIndex))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***lastRenderedRowIndex.value***REMOVED***=***REMOVED***params.rowCacheEnd;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***function***REMOVED***onRowHovered({***REMOVED***hovered,***REMOVED***rowKey***REMOVED***})***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isScrolling.value)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***tableRoot***REMOVED***=***REMOVED***tableInstance.vnode.el;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***rows***REMOVED***=***REMOVED***tableRoot.querySelectorAll(`[rowkey="${String(rowKey)}"]`);
***REMOVED******REMOVED******REMOVED******REMOVED***rows.forEach((row)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(hovered)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***row.classList.add(ns.is("hovered"));
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***row.classList.remove(ns.is("hovered"));
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED***}
***REMOVED******REMOVED***function***REMOVED***onRowExpanded({
***REMOVED******REMOVED******REMOVED******REMOVED***expanded,
***REMOVED******REMOVED******REMOVED******REMOVED***rowData,
***REMOVED******REMOVED******REMOVED******REMOVED***rowIndex,
***REMOVED******REMOVED******REMOVED******REMOVED***rowKey
***REMOVED******REMOVED***})***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***_a,***REMOVED***_b;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***_expandedRowKeys***REMOVED***=***REMOVED***[...unref(expandedRowKeys)];
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***currentKeyIndex***REMOVED***=***REMOVED***_expandedRowKeys.indexOf(rowKey);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(expanded)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(currentKeyIndex***REMOVED***===***REMOVED***-1)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***_expandedRowKeys.push(rowKey);
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(currentKeyIndex***REMOVED***>***REMOVED***-1)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***_expandedRowKeys.splice(currentKeyIndex,***REMOVED***1);
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***expandedRowKeys.value***REMOVED***=***REMOVED***_expandedRowKeys;
***REMOVED******REMOVED******REMOVED******REMOVED***emit("update:expandedRowKeys",***REMOVED***_expandedRowKeys);
***REMOVED******REMOVED******REMOVED******REMOVED***(_a***REMOVED***=***REMOVED***props.onRowExpand)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_a.call(props,***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***expanded,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rowData,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rowIndex,
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rowKey
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED******REMOVED******REMOVED***(_b***REMOVED***=***REMOVED***props.onExpandedRowsChange)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_b.call(props,***REMOVED***_expandedRowKeys);
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***tableRoot***REMOVED***=***REMOVED***tableInstance.vnode.el;
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***hoverRow***REMOVED***=***REMOVED***tableRoot.querySelector(`.${ns.is("hovered")}[rowkey="${String(rowKey)}"]`);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(hoverRow)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***nextTick(()***REMOVED***=>***REMOVED***onRowHovered({***REMOVED***hovered:***REMOVED***true,***REMOVED***rowKey***REMOVED***}));
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***const***REMOVED***flushingRowHeights***REMOVED***=***REMOVED***debounce(()***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***var***REMOVED***_a,***REMOVED***_b,***REMOVED***_c,***REMOVED***_d;
***REMOVED******REMOVED******REMOVED******REMOVED***isResetting.value***REMOVED***=***REMOVED***true;
***REMOVED******REMOVED******REMOVED******REMOVED***rowHeights.value***REMOVED***=***REMOVED***{***REMOVED***...unref(rowHeights),***REMOVED***...unref(pendingRowHeights)***REMOVED***};
***REMOVED******REMOVED******REMOVED******REMOVED***resetAfterIndex(unref(resetIndex),***REMOVED***false);
***REMOVED******REMOVED******REMOVED******REMOVED***pendingRowHeights.value***REMOVED***=***REMOVED***{};
***REMOVED******REMOVED******REMOVED******REMOVED***resetIndex.value***REMOVED***=***REMOVED***null;
***REMOVED******REMOVED******REMOVED******REMOVED***(_a***REMOVED***=***REMOVED***mainTableRef.value)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_a.forceUpdate();
***REMOVED******REMOVED******REMOVED******REMOVED***(_b***REMOVED***=***REMOVED***leftTableRef.value)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_b.forceUpdate();
***REMOVED******REMOVED******REMOVED******REMOVED***(_c***REMOVED***=***REMOVED***rightTableRef.value)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_c.forceUpdate();
***REMOVED******REMOVED******REMOVED******REMOVED***(_d***REMOVED***=***REMOVED***vm.proxy)***REMOVED***==***REMOVED***null***REMOVED***?***REMOVED***void***REMOVED***0***REMOVED***:***REMOVED***_d.$forceUpdate();
***REMOVED******REMOVED******REMOVED******REMOVED***isResetting.value***REMOVED***=***REMOVED***false;
***REMOVED******REMOVED***},***REMOVED***0);
***REMOVED******REMOVED***function***REMOVED***resetAfterIndex(index,***REMOVED***forceUpdate***REMOVED***=***REMOVED***false)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!unref(isDynamic))
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return;
***REMOVED******REMOVED******REMOVED******REMOVED***[mainTableRef,***REMOVED***leftTableRef,***REMOVED***rightTableRef].forEach((tableRef)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***table***REMOVED***=***REMOVED***unref(tableRef);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(table)
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***table.resetAfterRowIndex(index,***REMOVED***forceUpdate);
***REMOVED******REMOVED******REMOVED******REMOVED***});
***REMOVED******REMOVED***}
***REMOVED******REMOVED***function***REMOVED***resetHeights(rowKey,***REMOVED***height,***REMOVED***rowIdx)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***resetIdx***REMOVED***=***REMOVED***unref(resetIndex);
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(resetIdx***REMOVED***===***REMOVED***null)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***resetIndex.value***REMOVED***=***REMOVED***rowIdx;
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(resetIdx***REMOVED***>***REMOVED***rowIdx)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***resetIndex.value***REMOVED***=***REMOVED***rowIdx;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***pendingRowHeights.value[rowKey]***REMOVED***=***REMOVED***height;
***REMOVED******REMOVED***}
***REMOVED******REMOVED***function***REMOVED***onRowHeightChange({***REMOVED***rowKey,***REMOVED***height,***REMOVED***rowIndex***REMOVED***},***REMOVED***fixedDir)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!fixedDir)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***mainTableHeights.value[rowKey]***REMOVED***=***REMOVED***height;
***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(fixedDir***REMOVED***===***REMOVED***FixedDir.RIGHT)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***rightTableHeights.value[rowKey]***REMOVED***=***REMOVED***height;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***leftTableHeights.value[rowKey]***REMOVED***=***REMOVED***height;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***maximumHeight***REMOVED***=***REMOVED***Math.max(...[leftTableHeights,***REMOVED***rightTableHeights,***REMOVED***mainTableHeights].map((records)***REMOVED***=>***REMOVED***records.value[rowKey]***REMOVED***||***REMOVED***0));
***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(unref(rowHeights)[rowKey]***REMOVED***!==***REMOVED***maximumHeight)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***resetHeights(rowKey,***REMOVED***maximumHeight,***REMOVED***rowIndex);
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***flushingRowHeights();
***REMOVED******REMOVED******REMOVED******REMOVED***}
***REMOVED******REMOVED***}
***REMOVED******REMOVED***return***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***expandedRowKeys,
***REMOVED******REMOVED******REMOVED******REMOVED***lastRenderedRowIndex,
***REMOVED******REMOVED******REMOVED******REMOVED***isDynamic,
***REMOVED******REMOVED******REMOVED******REMOVED***isResetting,
***REMOVED******REMOVED******REMOVED******REMOVED***rowHeights,
***REMOVED******REMOVED******REMOVED******REMOVED***resetAfterIndex,
***REMOVED******REMOVED******REMOVED******REMOVED***onRowExpanded,
***REMOVED******REMOVED******REMOVED******REMOVED***onRowHovered,
***REMOVED******REMOVED******REMOVED******REMOVED***onRowsRendered,
***REMOVED******REMOVED******REMOVED******REMOVED***onRowHeightChange
***REMOVED******REMOVED***};
};

export***REMOVED***{***REMOVED***useRow***REMOVED***};
//#***REMOVED***sourceMappingURL=use-row.mjs.map
