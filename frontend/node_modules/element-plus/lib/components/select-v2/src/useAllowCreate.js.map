{"version":3,"file":"useAllowCreate.js","sources":["../../../../../../packages/components/select-v2/src/useAllowCreate.ts"],"sourcesContent":["import***REMOVED***{***REMOVED***computed,***REMOVED***ref,***REMOVED***watch***REMOVED***}***REMOVED***from***REMOVED***'vue'\nimport***REMOVED***{***REMOVED***useProps***REMOVED***}***REMOVED***from***REMOVED***'./useProps'\n\nimport***REMOVED***type***REMOVED***{***REMOVED***SelectV2Props***REMOVED***}***REMOVED***from***REMOVED***'./token'\nimport***REMOVED***type***REMOVED***{***REMOVED***Option,***REMOVED***SelectStates***REMOVED***}***REMOVED***from***REMOVED***'./select.types'\n\nexport***REMOVED***function***REMOVED***useAllowCreate(props:***REMOVED***SelectV2Props,***REMOVED***states:***REMOVED***SelectStates)***REMOVED***{\n***REMOVED******REMOVED***const***REMOVED***{***REMOVED***aliasProps,***REMOVED***getLabel,***REMOVED***getValue***REMOVED***}***REMOVED***=***REMOVED***useProps(props)\n\n***REMOVED******REMOVED***const***REMOVED***createOptionCount***REMOVED***=***REMOVED***ref(0)\n***REMOVED******REMOVED***const***REMOVED***cachedSelectedOption***REMOVED***=***REMOVED***ref<Option>()\n\n***REMOVED******REMOVED***const***REMOVED***enableAllowCreateMode***REMOVED***=***REMOVED***computed(()***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***props.allowCreate***REMOVED***&&***REMOVED***props.filterable\n***REMOVED******REMOVED***})\n\n***REMOVED******REMOVED***watch(\n***REMOVED******REMOVED******REMOVED******REMOVED***()***REMOVED***=>***REMOVED***props.options,\n***REMOVED******REMOVED******REMOVED******REMOVED***(options)***REMOVED***=>***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***optionLabelsSet***REMOVED***=***REMOVED***new***REMOVED***Set(options.map((option)***REMOVED***=>***REMOVED***getLabel(option)))\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions***REMOVED***=***REMOVED***states.createdOptions.filter(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(createdOption)***REMOVED***=>***REMOVED***!optionLabelsSet.has(getLabel(createdOption))\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***)\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***)\n\n***REMOVED******REMOVED***function***REMOVED***hasExistingOption(query:***REMOVED***string)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***hasOption***REMOVED***=***REMOVED***(option:***REMOVED***Option)***REMOVED***=>***REMOVED***getLabel(option)***REMOVED***===***REMOVED***query\n***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(props.options***REMOVED***&&***REMOVED***props.options.some(hasOption))***REMOVED***||\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.some(hasOption)\n***REMOVED******REMOVED******REMOVED******REMOVED***)\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***function***REMOVED***selectNewOption(option:***REMOVED***Option)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!enableAllowCreateMode.value)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(props.multiple***REMOVED***&&***REMOVED***option.created)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***createOptionCount.value++\n***REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***cachedSelectedOption.value***REMOVED***=***REMOVED***option\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***function***REMOVED***createNewOption(query:***REMOVED***string)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(enableAllowCreateMode.value)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(query***REMOVED***&&***REMOVED***query.length***REMOVED***>***REMOVED***0)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(hasExistingOption(query))***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions***REMOVED***=***REMOVED***states.createdOptions.filter(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(createdOption)***REMOVED***=>***REMOVED***getLabel(createdOption)***REMOVED***!==***REMOVED***states.previousQuery\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***newOption***REMOVED***=***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***[aliasProps.value.value]:***REMOVED***query,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***[aliasProps.value.label]:***REMOVED***query,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***created:***REMOVED***true,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***[aliasProps.value.disabled]:***REMOVED***false,\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(states.createdOptions.length***REMOVED***>=***REMOVED***createOptionCount.value)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions[createOptionCount.value]***REMOVED***=***REMOVED***newOption\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.push(newOption)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(props.multiple)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.length***REMOVED***=***REMOVED***createOptionCount.value\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***selectedOption***REMOVED***=***REMOVED***cachedSelectedOption.value\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.length***REMOVED***=***REMOVED***0\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(selectedOption***REMOVED***&&***REMOVED***selectedOption.created)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.push(selectedOption)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***function***REMOVED***removeNewOption(option:***REMOVED***Option)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***!enableAllowCreateMode.value***REMOVED***||\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***!option***REMOVED***||\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***!option.created***REMOVED***||\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(option.created***REMOVED***&&\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***props.reserveKeyword***REMOVED***&&\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.inputValue***REMOVED***===***REMOVED***getLabel(option))\n***REMOVED******REMOVED******REMOVED******REMOVED***)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***idx***REMOVED***=***REMOVED***states.createdOptions.findIndex(\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***(it)***REMOVED***=>***REMOVED***getValue(it)***REMOVED***===***REMOVED***getValue(option)\n***REMOVED******REMOVED******REMOVED******REMOVED***)\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(~idx)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.splice(idx,***REMOVED***1)\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***createOptionCount.value--\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***function***REMOVED***clearAllNewOption()***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(enableAllowCreateMode.value)***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***states.createdOptions.length***REMOVED***=***REMOVED***0\n***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***createOptionCount.value***REMOVED***=***REMOVED***0\n***REMOVED******REMOVED******REMOVED******REMOVED***}\n***REMOVED******REMOVED***}\n\n***REMOVED******REMOVED***return***REMOVED***{\n***REMOVED******REMOVED******REMOVED******REMOVED***createNewOption,\n***REMOVED******REMOVED******REMOVED******REMOVED***removeNewOption,\n***REMOVED******REMOVED******REMOVED******REMOVED***selectNewOption,\n***REMOVED******REMOVED******REMOVED******REMOVED***clearAllNewOption,\n***REMOVED******REMOVED***}\n}\n"],"names":["useProps","ref","computed","watch"],"mappings":"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"}