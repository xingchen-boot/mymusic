'use***REMOVED***strict';

import***REMOVED***utils***REMOVED***from***REMOVED***'../utils.js';

/**
***REMOVED*******REMOVED***It***REMOVED***takes***REMOVED***a***REMOVED***string***REMOVED***like***REMOVED***`foo[x][y][z]`***REMOVED***and***REMOVED***returns***REMOVED***an***REMOVED***array***REMOVED***like***REMOVED***`['foo',***REMOVED***'x',***REMOVED***'y',***REMOVED***'z']
***REMOVED****
***REMOVED*******REMOVED***@param***REMOVED***{string}***REMOVED***name***REMOVED***-***REMOVED***The***REMOVED***name***REMOVED***of***REMOVED***the***REMOVED***property***REMOVED***to***REMOVED***get.
***REMOVED****
***REMOVED*******REMOVED***@returns***REMOVED***An***REMOVED***array***REMOVED***of***REMOVED***strings.
***REMOVED****/
function***REMOVED***parsePropPath(name)***REMOVED***{
***REMOVED******REMOVED***//***REMOVED***foo[x][y][z]
***REMOVED******REMOVED***//***REMOVED***foo.x.y.z
***REMOVED******REMOVED***//***REMOVED***foo-x-y-z
***REMOVED******REMOVED***//***REMOVED***foo***REMOVED***x***REMOVED***y***REMOVED***z
***REMOVED******REMOVED***return***REMOVED***utils.matchAll(/\w+|\[(\w*)]/g,***REMOVED***name).map(match***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***match[0]***REMOVED***===***REMOVED***'[]'***REMOVED***?***REMOVED***''***REMOVED***:***REMOVED***match[1]***REMOVED***||***REMOVED***match[0];
***REMOVED******REMOVED***});
}

/**
***REMOVED*******REMOVED***Convert***REMOVED***an***REMOVED***array***REMOVED***to***REMOVED***an***REMOVED***object.
***REMOVED****
***REMOVED*******REMOVED***@param***REMOVED***{Array<any>}***REMOVED***arr***REMOVED***-***REMOVED***The***REMOVED***array***REMOVED***to***REMOVED***convert***REMOVED***to***REMOVED***an***REMOVED***object.
***REMOVED****
***REMOVED*******REMOVED***@returns***REMOVED***An***REMOVED***object***REMOVED***with***REMOVED***the***REMOVED***same***REMOVED***keys***REMOVED***and***REMOVED***values***REMOVED***as***REMOVED***the***REMOVED***array.
***REMOVED****/
function***REMOVED***arrayToObject(arr)***REMOVED***{
***REMOVED******REMOVED***const***REMOVED***obj***REMOVED***=***REMOVED***{};
***REMOVED******REMOVED***const***REMOVED***keys***REMOVED***=***REMOVED***Object.keys(arr);
***REMOVED******REMOVED***let***REMOVED***i;
***REMOVED******REMOVED***const***REMOVED***len***REMOVED***=***REMOVED***keys.length;
***REMOVED******REMOVED***let***REMOVED***key;
***REMOVED******REMOVED***for***REMOVED***(i***REMOVED***=***REMOVED***0;***REMOVED***i***REMOVED***<***REMOVED***len;***REMOVED***i++)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***key***REMOVED***=***REMOVED***keys[i];
***REMOVED******REMOVED******REMOVED******REMOVED***obj[key]***REMOVED***=***REMOVED***arr[key];
***REMOVED******REMOVED***}
***REMOVED******REMOVED***return***REMOVED***obj;
}

/**
***REMOVED*******REMOVED***It***REMOVED***takes***REMOVED***a***REMOVED***FormData***REMOVED***object***REMOVED***and***REMOVED***returns***REMOVED***a***REMOVED***JavaScript***REMOVED***object
***REMOVED****
***REMOVED*******REMOVED***@param***REMOVED***{string}***REMOVED***formData***REMOVED***The***REMOVED***FormData***REMOVED***object***REMOVED***to***REMOVED***convert***REMOVED***to***REMOVED***JSON.
***REMOVED****
***REMOVED*******REMOVED***@returns***REMOVED***{Object<string,***REMOVED***any>***REMOVED***|***REMOVED***null}***REMOVED***The***REMOVED***converted***REMOVED***object.
***REMOVED****/
function***REMOVED***formDataToJSON(formData)***REMOVED***{
***REMOVED******REMOVED***function***REMOVED***buildPath(path,***REMOVED***value,***REMOVED***target,***REMOVED***index)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***let***REMOVED***name***REMOVED***=***REMOVED***path[index++];

***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(name***REMOVED***===***REMOVED***'__proto__')***REMOVED***return***REMOVED***true;

***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***isNumericKey***REMOVED***=***REMOVED***Number.isFinite(+name);
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***isLast***REMOVED***=***REMOVED***index***REMOVED***>=***REMOVED***path.length;
***REMOVED******REMOVED******REMOVED******REMOVED***name***REMOVED***=***REMOVED***!name***REMOVED***&&***REMOVED***utils.isArray(target)***REMOVED***?***REMOVED***target.length***REMOVED***:***REMOVED***name;

***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(isLast)***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(utils.hasOwnProp(target,***REMOVED***name))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***target[name]***REMOVED***=***REMOVED***[target[name],***REMOVED***value];
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}***REMOVED***else***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***target[name]***REMOVED***=***REMOVED***value;
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***!isNumericKey;
***REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(!target[name]***REMOVED***||***REMOVED***!utils.isObject(target[name]))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***target[name]***REMOVED***=***REMOVED***[];
***REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***result***REMOVED***=***REMOVED***buildPath(path,***REMOVED***value,***REMOVED***target[name],***REMOVED***index);

***REMOVED******REMOVED******REMOVED******REMOVED***if***REMOVED***(result***REMOVED***&&***REMOVED***utils.isArray(target[name]))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***target[name]***REMOVED***=***REMOVED***arrayToObject(target[name]);
***REMOVED******REMOVED******REMOVED******REMOVED***}

***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***!isNumericKey;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***if***REMOVED***(utils.isFormData(formData)***REMOVED***&&***REMOVED***utils.isFunction(formData.entries))***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***const***REMOVED***obj***REMOVED***=***REMOVED***{};

***REMOVED******REMOVED******REMOVED******REMOVED***utils.forEachEntry(formData,***REMOVED***(name,***REMOVED***value)***REMOVED***=>***REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED******REMOVED******REMOVED***buildPath(parsePropPath(name),***REMOVED***value,***REMOVED***obj,***REMOVED***0);
***REMOVED******REMOVED******REMOVED******REMOVED***});

***REMOVED******REMOVED******REMOVED******REMOVED***return***REMOVED***obj;
***REMOVED******REMOVED***}

***REMOVED******REMOVED***return***REMOVED***null;
}

export***REMOVED***default***REMOVED***formDataToJSON;
