#***REMOVED***用户播放列表功能实现说明

##***REMOVED***功能概述

已成功实现用户个人播放列表功能，用户可以创建、管理自己的播放列表，并将音乐添加到播放列表中。每次登录时都会自动加载用户的播放列表。

##***REMOVED***数据库设计

###***REMOVED***1.***REMOVED***用户播放列表表***REMOVED***(user_playlist)
```sql
CREATE***REMOVED***TABLE***REMOVED***`user_playlist`***REMOVED***(
***REMOVED******REMOVED******REMOVED******REMOVED***`id`***REMOVED***BIGINT***REMOVED***AUTO_INCREMENT***REMOVED***PRIMARY***REMOVED***KEY***REMOVED***COMMENT***REMOVED***'播放列表ID',
***REMOVED******REMOVED******REMOVED******REMOVED***`user_id`***REMOVED***BIGINT***REMOVED***NOT***REMOVED***NULL***REMOVED***COMMENT***REMOVED***'用户ID',
***REMOVED******REMOVED******REMOVED******REMOVED***`name`***REMOVED***VARCHAR(100)***REMOVED***NOT***REMOVED***NULL***REMOVED***COMMENT***REMOVED***'播放列表名称',
***REMOVED******REMOVED******REMOVED******REMOVED***`description`***REMOVED***TEXT***REMOVED***COMMENT***REMOVED***'播放列表描述',
***REMOVED******REMOVED******REMOVED******REMOVED***`cover_url`***REMOVED***VARCHAR(255)***REMOVED***COMMENT***REMOVED***'封面图片URL',
***REMOVED******REMOVED******REMOVED******REMOVED***`create_time`***REMOVED***DATETIME***REMOVED***DEFAULT***REMOVED***CURRENT_TIMESTAMP***REMOVED***COMMENT***REMOVED***'创建时间',
***REMOVED******REMOVED******REMOVED******REMOVED***`update_time`***REMOVED***DATETIME***REMOVED***DEFAULT***REMOVED***CURRENT_TIMESTAMP***REMOVED***ON***REMOVED***UPDATE***REMOVED***CURRENT_TIMESTAMP***REMOVED***COMMENT***REMOVED***'更新时间',
***REMOVED******REMOVED******REMOVED******REMOVED***`status`***REMOVED***TINYINT***REMOVED***DEFAULT***REMOVED***1***REMOVED***COMMENT***REMOVED***'状态：0-删除，1-正常',
***REMOVED******REMOVED******REMOVED******REMOVED***FOREIGN***REMOVED***KEY***REMOVED***(`user_id`)***REMOVED***REFERENCES***REMOVED***`user`(`id`)***REMOVED***ON***REMOVED***DELETE***REMOVED***CASCADE
);
```

###***REMOVED***2.***REMOVED***播放列表音乐关联表***REMOVED***(playlist_music)
```sql
CREATE***REMOVED***TABLE***REMOVED***`playlist_music`***REMOVED***(
***REMOVED******REMOVED******REMOVED******REMOVED***`id`***REMOVED***BIGINT***REMOVED***AUTO_INCREMENT***REMOVED***PRIMARY***REMOVED***KEY***REMOVED***COMMENT***REMOVED***'关联ID',
***REMOVED******REMOVED******REMOVED******REMOVED***`playlist_id`***REMOVED***BIGINT***REMOVED***NOT***REMOVED***NULL***REMOVED***COMMENT***REMOVED***'播放列表ID',
***REMOVED******REMOVED******REMOVED******REMOVED***`music_id`***REMOVED***VARCHAR(100)***REMOVED***NOT***REMOVED***NULL***REMOVED***COMMENT***REMOVED***'音乐ID',
***REMOVED******REMOVED******REMOVED******REMOVED***`music_name`***REMOVED***VARCHAR(200)***REMOVED***NOT***REMOVED***NULL***REMOVED***COMMENT***REMOVED***'音乐名称',
***REMOVED******REMOVED******REMOVED******REMOVED***`artist_name`***REMOVED***VARCHAR(200)***REMOVED***COMMENT***REMOVED***'艺术家名称',
***REMOVED******REMOVED******REMOVED******REMOVED***`album_name`***REMOVED***VARCHAR(200)***REMOVED***COMMENT***REMOVED***'专辑名称',
***REMOVED******REMOVED******REMOVED******REMOVED***`duration`***REMOVED***INT***REMOVED***COMMENT***REMOVED***'时长（秒）',
***REMOVED******REMOVED******REMOVED******REMOVED***`music_url`***REMOVED***VARCHAR(500)***REMOVED***COMMENT***REMOVED***'音乐文件URL',
***REMOVED******REMOVED******REMOVED******REMOVED***`cover_url`***REMOVED***VARCHAR(500)***REMOVED***COMMENT***REMOVED***'封面图片URL',
***REMOVED******REMOVED******REMOVED******REMOVED***`add_time`***REMOVED***DATETIME***REMOVED***DEFAULT***REMOVED***CURRENT_TIMESTAMP***REMOVED***COMMENT***REMOVED***'添加时间',
***REMOVED******REMOVED******REMOVED******REMOVED***`sort_order`***REMOVED***INT***REMOVED***DEFAULT***REMOVED***0***REMOVED***COMMENT***REMOVED***'排序顺序',
***REMOVED******REMOVED******REMOVED******REMOVED***FOREIGN***REMOVED***KEY***REMOVED***(`playlist_id`)***REMOVED***REFERENCES***REMOVED***`user_playlist`(`id`)***REMOVED***ON***REMOVED***DELETE***REMOVED***CASCADE
);
```

##***REMOVED***后端API接口

###***REMOVED***播放列表管理

####***REMOVED***1.***REMOVED***获取用户播放列表
-***REMOVED*****URL**:***REMOVED***`GET***REMOVED***/api/user-playlist/user/{userId}`
-***REMOVED*****返回**:***REMOVED***用户的播放列表列表

####***REMOVED***2.***REMOVED***创建播放列表
-***REMOVED*****URL**:***REMOVED***`POST***REMOVED***/api/user-playlist/create`
-***REMOVED*****参数**:
***REMOVED******REMOVED***```json
***REMOVED******REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***"userId":***REMOVED***1,
***REMOVED******REMOVED******REMOVED******REMOVED***"name":***REMOVED***"我的收藏",
***REMOVED******REMOVED******REMOVED******REMOVED***"description":***REMOVED***"我喜欢的音乐"
***REMOVED******REMOVED***}
***REMOVED******REMOVED***```

####***REMOVED***3.***REMOVED***获取播放列表详情
-***REMOVED*****URL**:***REMOVED***`GET***REMOVED***/api/user-playlist/{id}`
-***REMOVED*****返回**:***REMOVED***播放列表详情（包含音乐列表）

####***REMOVED***4.***REMOVED***更新播放列表
-***REMOVED*****URL**:***REMOVED***`PUT***REMOVED***/api/user-playlist/{id}`
-***REMOVED*****参数**:
***REMOVED******REMOVED***```json
***REMOVED******REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***"name":***REMOVED***"新名称",
***REMOVED******REMOVED******REMOVED******REMOVED***"description":***REMOVED***"新描述",
***REMOVED******REMOVED******REMOVED******REMOVED***"coverUrl":***REMOVED***"封面URL"
***REMOVED******REMOVED***}
***REMOVED******REMOVED***```

####***REMOVED***5.***REMOVED***删除播放列表
-***REMOVED*****URL**:***REMOVED***`DELETE***REMOVED***/api/user-playlist/{id}`

###***REMOVED***音乐管理

####***REMOVED***1.***REMOVED***添加音乐到播放列表
-***REMOVED*****URL**:***REMOVED***`POST***REMOVED***/api/user-playlist/{playlistId}/music`
-***REMOVED*****参数**:
***REMOVED******REMOVED***```json
***REMOVED******REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***"musicId":***REMOVED***"music123",
***REMOVED******REMOVED******REMOVED******REMOVED***"musicName":***REMOVED***"歌曲名称",
***REMOVED******REMOVED******REMOVED******REMOVED***"artistName":***REMOVED***"艺术家",
***REMOVED******REMOVED******REMOVED******REMOVED***"albumName":***REMOVED***"专辑名称",
***REMOVED******REMOVED******REMOVED******REMOVED***"duration":***REMOVED***240,
***REMOVED******REMOVED******REMOVED******REMOVED***"musicUrl":***REMOVED***"音乐文件URL",
***REMOVED******REMOVED******REMOVED******REMOVED***"coverUrl":***REMOVED***"封面URL"
***REMOVED******REMOVED***}
***REMOVED******REMOVED***```

####***REMOVED***2.***REMOVED***从播放列表移除音乐
-***REMOVED*****URL**:***REMOVED***`DELETE***REMOVED***/api/user-playlist/{playlistId}/music/{musicId}`

####***REMOVED***3.***REMOVED***获取播放列表中的音乐
-***REMOVED*****URL**:***REMOVED***`GET***REMOVED***/api/user-playlist/{playlistId}/music`

####***REMOVED***4.***REMOVED***更新音乐排序
-***REMOVED*****URL**:***REMOVED***`PUT***REMOVED***/api/user-playlist/music/{musicId}/sort`
-***REMOVED*****参数**:
***REMOVED******REMOVED***```json
***REMOVED******REMOVED***{
***REMOVED******REMOVED******REMOVED******REMOVED***"sortOrder":***REMOVED***1
***REMOVED******REMOVED***}
***REMOVED******REMOVED***```

####***REMOVED***5.***REMOVED***清空播放列表
-***REMOVED*****URL**:***REMOVED***`DELETE***REMOVED***/api/user-playlist/{playlistId}/clear`

####***REMOVED***6.***REMOVED***检查音乐是否在播放列表中
-***REMOVED*****URL**:***REMOVED***`GET***REMOVED***/api/user-playlist/{playlistId}/check/{musicId}`

##***REMOVED***前端功能

###***REMOVED***用户Store新增功能

####***REMOVED***状态管理
-***REMOVED***`userPlaylists`:***REMOVED***用户播放列表数组
-***REMOVED***自动在登录时加载播放列表
-***REMOVED***播放列表数据持久化到localStorage

####***REMOVED***新增方法
1.***REMOVED***`loadUserPlaylists()`:***REMOVED***加载用户播放列表
2.***REMOVED***`createPlaylist(name,***REMOVED***description)`:***REMOVED***创建播放列表
3.***REMOVED***`addMusicToPlaylist(playlistId,***REMOVED***music)`:***REMOVED***添加音乐到播放列表
4.***REMOVED***`removeMusicFromPlaylist(playlistId,***REMOVED***musicId)`:***REMOVED***从播放列表移除音乐
5.***REMOVED***`deletePlaylist(playlistId)`:***REMOVED***删除播放列表

###***REMOVED***数据结构

####***REMOVED***UserPlaylist接口
```typescript
interface***REMOVED***UserPlaylist***REMOVED***{
***REMOVED******REMOVED***id:***REMOVED***number
***REMOVED******REMOVED***userId:***REMOVED***number
***REMOVED******REMOVED***name:***REMOVED***string
***REMOVED******REMOVED***description?:***REMOVED***string
***REMOVED******REMOVED***coverUrl?:***REMOVED***string
***REMOVED******REMOVED***createTime:***REMOVED***string
***REMOVED******REMOVED***updateTime:***REMOVED***string
***REMOVED******REMOVED***status:***REMOVED***number
***REMOVED******REMOVED***musicList?:***REMOVED***PlaylistMusic[]
}
```

####***REMOVED***PlaylistMusic接口
```typescript
interface***REMOVED***PlaylistMusic***REMOVED***{
***REMOVED******REMOVED***id?:***REMOVED***number
***REMOVED******REMOVED***playlistId?:***REMOVED***number
***REMOVED******REMOVED***musicId:***REMOVED***string
***REMOVED******REMOVED***musicName:***REMOVED***string
***REMOVED******REMOVED***artistName?:***REMOVED***string
***REMOVED******REMOVED***albumName?:***REMOVED***string
***REMOVED******REMOVED***duration?:***REMOVED***number
***REMOVED******REMOVED***musicUrl?:***REMOVED***string
***REMOVED******REMOVED***coverUrl?:***REMOVED***string
***REMOVED******REMOVED***addTime?:***REMOVED***string
***REMOVED******REMOVED***sortOrder?:***REMOVED***number
}
```

##***REMOVED***使用说明

###***REMOVED***1.***REMOVED***初始化数据库
运行***REMOVED***`init-user-playlist.bat`***REMOVED***创建播放列表相关的数据库表。

###***REMOVED***2.***REMOVED***启动服务
```bash
#***REMOVED***启动后端
cd***REMOVED***springboot
mvn***REMOVED***spring-boot:run

#***REMOVED***启动前端
cd***REMOVED***frontend
npm***REMOVED***run***REMOVED***dev
```

###***REMOVED***3.***REMOVED***功能使用
1.***REMOVED*****用户登录**:***REMOVED***登录成功后自动加载用户的播放列表
2.***REMOVED*****创建播放列表**:***REMOVED***调用***REMOVED***`userStore.createPlaylist()`***REMOVED***方法
3.***REMOVED*****添加音乐**:***REMOVED***调用***REMOVED***`userStore.addMusicToPlaylist()`***REMOVED***方法
4.***REMOVED*****管理播放列表**:***REMOVED***使用相应的API方法进行增删改查

##***REMOVED***功能特点

1.***REMOVED*****用户隔离**:***REMOVED***每个用户只能看到和管理自己的播放列表
2.***REMOVED*****数据持久化**:***REMOVED***播放列表数据存储在数据库中，登录时自动加载
3.***REMOVED*****级联删除**:***REMOVED***删除用户时自动删除其所有播放列表
4.***REMOVED*****音乐排序**:***REMOVED***支持播放列表内音乐的排序功能
5.***REMOVED*****软删除**:***REMOVED***播放列表使用软删除，数据不会真正丢失
6.***REMOVED*****重复检查**:***REMOVED***防止同一音乐重复添加到播放列表

##***REMOVED***后续扩展

可以考虑添加以下功能：
-***REMOVED***播放列表分享功能
-***REMOVED***播放列表导入/导出
-***REMOVED***播放列表封面自动生成
-***REMOVED***播放列表播放统计
-***REMOVED***播放列表标签分类
-***REMOVED***播放列表搜索功能

